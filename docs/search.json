[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Kioloa PopGen",
    "section": "",
    "text": "Welcome!\nWelcome, Fellow Magical Beings, to our 5-day spellbinding journey in the mystical realm of Population Genetics using the ancient art of R! We’re over the moon (and not just because we’ve mastered levitation spells) to have you join us at the enchanted Kioloa ANU Coastal Campus. Nestled among the spellbound forests of Murramarang Nation Park and the crystal-clear waters of southern New South Wales, our meeting lair couldn’t be more perfect. When you’re not weaving R spells, you’ll find yourself spoiled for choice with magical brews (a.k.a. coffee) and breathtaking sceneries.\nOur coven is as varied as the potions in a wizard’s pantry, bringing together sorcerers from all corners of the realm. Here, every sorcerer and sorceress will don both the student’s cloak and the teacher’s hat, expanding their arcane knowledge in genetics for the noble causes of biodiversity conservation and ecosystem restoration. Expect a cauldron bubbling with interaction, where being right is as celebrated as making mistakes, where sensitivity meets resilience, and where every voice conjures new spells of knowledge, perspective, and innovation.\nOur quest is to master key incantations in population genetics, with our wands pointed firmly at the R statistical grimoire. We’re ditching the dusty tomes for hands-on magic, aiming to empower you to conjure your own population genetics enchantments by the end of our gathering. And fear not, there will be ample time to apply these spells on your own datasets.\nOur magic words? Cooperation, flexibility, and dedication. We embark on this journey with a spirit of camaraderie, ready to share potions, carry scrolls, and lend a helping wand in times of need. The path may twist and turn, with unexpected dragons (breakdowns), storms (rain), and spells gone awry (tech hiccups), but our collective humour and knack for improvisation will see us through.\nWe are united by a deep-seated dedication to unravelling the mysteries of genetics, a passion that burns as bright within you as it does within us. We believe this adventure will be rewarding not just intellectually, but also aesthetically, socially, and culturally. We can’t wait to embark on this enchanting journey with you. May our time together be as fulfilling as finding the philosopher’s stone!"
  },
  {
    "objectID": "index.html#here-are-some-things-you-might-see-along-your-journey",
    "href": "index.html#here-are-some-things-you-might-see-along-your-journey",
    "title": "Kioloa PopGen",
    "section": "Here are some things you might see along your journey:",
    "text": "Here are some things you might see along your journey:\nBelow is an exercise box, this is encouraging you to give it a go yourself!\n\n\n\n\n\n\nExercise\n\n\n\n Give the code a go!\n\n\nBelow is a tip box, with added insights for your journey.\n\n\n\n\n\n\nTip\n\n\n\ntake a look…\nA variety of things to learn!\n\n\nBelow is a caution box, take note, this will keep you on your path.\n\n\n\n\n\n\nCaution\n\n\n\nTake CARE! It is easy to go astray, I am here to help.\n\n\nBelow is a warning box! Be careful and take head of what it says.\n\n\n\n\n\n\nWarning\n\n\n\nNOTICE! Thank you for noticing this warning!"
  },
  {
    "objectID": "index.html#a-big-thank-you-to-the-developers",
    "href": "index.html#a-big-thank-you-to-the-developers",
    "title": "Kioloa PopGen",
    "section": "A big thank you to the developers!",
    "text": "A big thank you to the developers!\nDartR published first by Gruber et al. (2018), and DartR V2 published by Mijangos et al. (2022)\n\n\n\n\nGruber, Bernd, Peter J. Unmack, Oliver F. Berry, and Arthur Georges. 2018. “DARTR : An R Package to Facilitate Analysis of SNP Data Generated from Reduced Representation Genome Sequencing.” Molecular Ecology Resources 18 (3): 691–99. https://doi.org/10.1111/1755-0998.12745.\n\n\nMijangos, Jose Luis, Bernd Gruber, Oliver Berry, Carlo Pacioni, and Arthur Georges. 2022. “dartR V2: An Accessible Genetic Analysis Platform for Conservation, Ecology and Agriculture.” Methods in Ecology and Evolution 13 (10): 2150–58. https://doi.org/10.1111/2041-210X.13918."
  },
  {
    "objectID": "schedule.html",
    "href": "schedule.html",
    "title": "Program",
    "section": "",
    "text": "for a more detailed program see the More Info section\n\n\n\n\n\n\n\n\n\n\n\n#\nDay\nTime\nTopic\nPresenters\n\n\n\n\n1\nMon\n2 pm - 4 pm\nWelcome, Intro dartR\nOliver Berry, Andrzej Killian, Arthur Georges, Bernd Gruber, Renee Catullo\n\n\n2\n\n5 pm – 7 pm\nPop Gen In Conservation & Restoration\nBill Sherwin, Carlo Pacioni, Renee Catullo\n\n\n3\nTue\n9 am – 11 am\nSequencing Technologies\nJason Carling, Andrew Kowalczyk, Renee Catullo\n\n\n4\n\n12 pm – 2 pm\nData Management, Reproducibility & Integrity\nJiajia Li\n\n\n5\n\n3 pm – 5 pm\nEffective Population Size\nBernd Gruber, Carlo Pacioni, Bill Sherwin\n\n\n6\nWed\n9 am – 11 am\nManagement Of Small Populations\nCatherine Grueber, Kate Farquharson\n\n\n7\n\n12 pm – 2 pm\nNatural Selection\nLuciano Beheregaray, Chris Brauer, Jonathan Sandoval\n\n\n8\n\n3 pm – 5 pm\nLandscape Genetics\nBernd Gruber, Robyn Shaw\n\n\n9\nThu\n9 am – 11 am\nLineage Divergence\nArthur Georges, Sally Potter, Craig Moritz\n\n\n10\n\n12 pm – 2 pm\nSex Linked Markers\nDiana Robledo, Floriaan Devloo-Delva\n\n\n11\n\n7 pm – 9 pm\nFrom Genes to Kin: Dissecting Relatedness & Kinship\nJinliang Wang, Luis Mijangos, Natasha Marosi\n\n\n12\nFri\n9 am – 11 am\nGenetic Structure\nArthur Georges, Bernd Gruber, Bill Sherwin\n\n\n13\n\n12 pm – 2 pm\nCombining Genomic Resources\nLuis Mijangos, Sally Potter"
  },
  {
    "objectID": "install.html#rationale",
    "href": "install.html#rationale",
    "title": "Install dartRverse",
    "section": "Rationale",
    "text": "Rationale\nWe have developed a new suit of packages called “dartRverse” packages, that will replace the previous dartR package, which soon will be no longer supported. The new suit of packages are meant to be a 1:1 replacement and only in some instance very minor changes will be needed to update previous code. For example we reworked on the “output” of all functions, now being able to save figures in specified folders, which can be easier recovered and manipulated for further tweaking. The main reasons for splitting dartR into several packages and developing the dartRverse suit of packages was difficulty to maintain dartR, because of limits imposed by CRAN, but also limits due the the long time to test new function, when compiling the package. Therefore we were forced to split the package into several smaller packages. This has several advantages and in the best of all cases no disadvantages.\n\neasier maintenance\nfaster development\nless dependencies on other packages\neasier to become a contributor\nhave your own package developed that can be branded as part of the dartRverse\n\nThe main paradigm was also that for our users nothing (or at as little as possible) needed to change and all existing code and scripts should still work. Also the installation process was meant to be straightforward and finally the coexistance between dartR and dartRverse packages should be possible (for the interim until dartR will be no longer supported)."
  },
  {
    "objectID": "install.html#installation",
    "href": "install.html#installation",
    "title": "Install dartRverse",
    "section": "Installation",
    "text": "Installation\n\ninstall dartRverse\n\n#installs the necessary bioconductor packages\ninstall.packages(\"devtools\")\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"SNPRelate\")\n\n#install dartRverse (dartRverse) & core (dartR.base, dartR.data)\ninstall.packages(\"dartRverse\")\n\nThe dartRverse package is the first package to install and its only purpose is to support the installation of the other dartRverse packages. It will also be the first port of call to provide links to tutorials and other documentation.\nIf everything works well this should install two more packages with form the core version of dartRverse, nameley dartR.base and dartR.data. Those core packages have all the main function of old dartR package that deals with input, conversion, reporting and filtering of data. Also some base function to analysse data (e.g. PCoA, Fst) are included.\nOnce the dartRverse package has been installed we can load the package to check which part of the dartRverse has been installed.\n\nlibrary(dartRverse)\n\n\n\n\n\n\n\n\ninstall additional packages\nNow we can install the additional packages that are part of the dartRverse. Depending on your needs you can install all of them or only the one you are interested.\nFor example if you are interested in additional functions to analyse population structure (e.g. run STRUCTURE or faststructure) you can install the dartR.popgen package. If you are interested in functions that support the simulation of data you can install the dartR.sim package.\nYou can check which packages are avaialbel and which of them you have installed by typing:\n\ndartRverse::dartRverse_install()\n\n\n\n\n\n\nThe currently available packages are:\n\ndartR.sim (simulate SNP data)\ndartR.popgen (run population genetic analysis)\ndartR.spatial (run landscape genetic analysis)\ndartR.captive (estimate relatedness, support captive breeding)\ndartR.sexlinked (identify sexlinked markers, not ready yet)\n\nSo to install the dartR.sim simply type:\n\ninstall.packages(\"dartR.sim\")\ninstall.packages(\"dartR.popgen\")\ninstall.packages(\"dartR.spatial\")\ninstall.packages(\"dartR.captive\")\n# currently dartR.sexlinked requires a different installation process (see below)\n\n\n\nGithub repositories\nWe make all of our packages available via CRAN. The reason for this is that CRAN packages follow a stringent testing before they are allowed to be uploaded to CRAN and therefore are more likely to contain less errors then packages that are available on other repositories. Nevertheless we also make our packages available during development via github.\nYou can find the repositories under: https://github.com/green-striped-gecko/dartR.base [for the dartR.base package] and equivalent for the other packages.\nThe reason why you might want to install a package from github is that you want to use the latest version of the package. However, you should be aware that the packages on github are not tested and therefore might contain errors. Also the packages on github might be updated on a daily basis and therefore might change without notice.\nWe use different branches and they are reflecting different stages of development and majurity.\n\nmain (the main branch, which is equivalent to the current CRAN version)\ndev (development branch, which has the latest functions that might be in the next CRAN version, but have not been tested yet)\ndev_name (these are branches of our main developers and are used for testing and development of new functions. Installing functions from here might cause problems and should only be done if you know what you are doing)\n\ndartRverse supports the installation of github version of the packages using the following syntax:\ndartRverse_install(package = \"dartR.base\", repo = \"github\", branch = \"dev\")\nThis install the dev branch of dartR.base from CRAN. All main and dev branches are tested if they can be installed (and some additional error checks via): https://github.com/green-striped-gecko/dartRverse\nPlease note that you should provide the package repository (github/cran), the branch (main, dev,dev_name) and version number in case you want to report a bug. You can use the github methods to report issues or use our google group: https://groups.google.com/d/forum/dartr.\n\n\nInstalling dartR.sexlinked\ndartRverse_install(package = \"dartR.sexlinked\", repo = \"github\", branch = \"dev\")"
  },
  {
    "objectID": "install.html#using-dartrverse",
    "href": "install.html#using-dartrverse",
    "title": "Install dartRverse",
    "section": "Using dartRverse",
    "text": "Using dartRverse\nTo use dartRverse you can simply load the package and use it as before.\n\nlibrary(dartRverse)"
  },
  {
    "objectID": "install.html#using-legacy-dartr",
    "href": "install.html#using-legacy-dartr",
    "title": "Install dartRverse",
    "section": "Using legacy dartR",
    "text": "Using legacy dartR\nFor whatever reason you might want to use legacy dartR, instead of the dartRverse packages [e.g. for initial testing]. For a detailed explanation on how to do this see the dartR Tutorials section that has an in depth walk through of how to do this in the Installing R tutorial PDF."
  },
  {
    "objectID": "session01.html#required-packages",
    "href": "session01.html#required-packages",
    "title": "1  Intro to dartR",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\nlibrary(dartR.data)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session01.html#the-dartrverse",
    "href": "session01.html#the-dartrverse",
    "title": "1  Intro to dartR",
    "section": "The dartRverse",
    "text": "The dartRverse\n\nFrom 1 package to 7\n See the section Install dartRverse to learn about the reasoning behind how the dartRverse came to be…"
  },
  {
    "objectID": "session01.html#the-magical-world-of-rstudio-cloud",
    "href": "session01.html#the-magical-world-of-rstudio-cloud",
    "title": "1  Intro to dartR",
    "section": "The magical world of RStudio Cloud",
    "text": "The magical world of RStudio Cloud\n\nStep 1: Summoning the RStudio Cloud Portal\n\nEmbark on the Journey: Open your trusty steed (a.k.a. your web browser) and gallop over to Rstudio Cloud.\nForge Your Credentials: Spot the “Sign Up” beacon in the realm’s upper right corner and click it with courage. Click on the “Learn more” below the “Cloud Free” plan and then in the “Sign Up” button. A scroll will appear, asking for your name, your secret code (password), and your e-mail. Please use the same e-mail you provided when you registered to the workshop.\n\n\n\nProve Your Worth: After submitting your details, a pigeon (or was it an email?) will fly into your inbox carrying a secret message. Click the link within to prove you’re not a goblin in disguise.\n\n\n\nStep 2: Entering the Secret Workshop Chamber\n\nReturn to the Portal: With your email now verified, make your way back to the RStudio Cloud realm and use your newly forged credentials to enter.\nFinding the Secret Door: One day before the workshop, a link leading to the workshop’s chamber will be sent to your e-mail.\n\n\n\nStep 3: Joining the Fellowship of the Project\n\nLocate the Treasure Chest: Within the grand chamber (workshop space), seek the project “PopGenR” and click on it to reveal its secrets. As you open it for the first time, ancient RStudio Cloud spirits will work their magic to prepare your environment."
  },
  {
    "objectID": "session01.html#dartr-fundamentals",
    "href": "session01.html#dartr-fundamentals",
    "title": "1  Intro to dartR",
    "section": "dartR fundamentals",
    "text": "dartR fundamentals\n\nThe structure of a genlight object\n\n\n\n\n\nFor a detailed rundown of the genetic data used by the dartRverse, check out the tuturial on Data Structure and Input found in the dartR Tutorials section.\n\n\nthe Basics\nHere is a glimpse at the functions we will be using. Please follow along, or try running the code on your own.\n\ncodegenlight\n\n\n\ntestset.gl\n\ngl &lt;- testset.gl\nnInd(gl)\nnLoc(gl)\nnPop(gl)\npopNames(gl)\nindNames(gl)\nlocNames(gl)\ntable(pop(gl))\nas.matrix(gl)[1:7,1:5]\n\n\n\n\ntestset.gl\n\n /// GENLIGHT OBJECT /////////\n\n // 250 genotypes,  255 binary SNPs, size: 752 Kb\n 7868 (12.34 %) missing data\n\n // Basic content\n   @gen: list of 250 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n // Optional content\n   @ind.names:  250 individual labels\n   @loc.names:  255 locus labels\n   @loc.all:  255 alleles\n   @position: integer storing positions of the SNPs\n   @pop: population of each individual (group size range: 1-11)\n   @other: a list containing: loc.metrics  latlong  ind.metrics  history  loc.metrics.flags \n\n\n\n\n\n\n\n\n\n\n\nQuiz!\n\n\n\nThis quiz is refering to the testset.gl dataset you have interrogated above.\nType the correct number into the blank boxes below:\n\nnumber of SNPs \nnumber of individuals \nnumber of populations \n\nboxes will go green if you have the answer correct\n\n\n\nReporting and Filtering\n\ncodeloci callrateindividual callratereproducibilityfilter callrate\n\n\n\ngl.set.verbosity(3)\n\ngl.report.callrate(gl)               # loci callrate             \ngl.report.callrate(gl,method=\"ind\")  # individual callrate\ngl.report.reproducibility(gl)        # reproducibility\n\n# filter\ngl.filter.callrate(gl,method =\"ind\", threshold=0.8)\n\n\n\n\ngl.report.callrate(gl)\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n  Reporting Call Rate by Locus\n  No. of loci = 255 \n  No. of individuals = 250 \n    Minimum      :  0.056 \n    1st quartile :  0.912 \n    Median       :  0.984 \n    Mean         :  0.8765804 \n    3r quartile  :  1 \n    Maximum      :  1 \n    Missing Rate Overall:  0.1234 \n\n\n\n\n\nCompleted: gl.report.callrate \n\n\n\n\n\ngl.report.callrate(gl,method=\"ind\")\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n\n  Reporting Call Rate by Individual\n  No. of loci = 255 \n  No. of individuals = 250 \n    Minimum      :  0.7490196 \n    1st quartile :  0.8666667 \n    Median       :  0.8823529 \n    Mean         :  0.8765804 \n    3r quartile  :  0.8941176 \n    Maximum      :  0.9333333 \n    Missing Rate Overall:  0.1234 \n\nListing 30 populations and their average CallRates\n  Monitor again after filtering\n         Population CallRate  N\n1     EmmacBrisWive   0.8839 10\n2     EmmacBurdMist   0.8808 10\n3     EmmacBurnBara   0.8859 11\n4     EmmacClarJack   0.8596  5\n5     EmmacClarYate   0.8769  5\n6     EmmacCoopAvin   0.7682 10\n7    EmmacCoopCully   0.9122 10\n8     EmmacCoopEulb   0.8702 10\n9    EmmacFitzAllig   0.8973 10\n10    EmmacJohnWari   0.8929 10\n11    EmmacMaclGeor   0.8806 11\n12    EmmacMaryBoru   0.8843  6\n13    EmmacMaryPetr   0.8892  4\n14     EmmacMDBBowm   0.8824 10\n15     EmmacMDBCond   0.8855 10\n16     EmmacMDBCudg   0.8878 10\n17     EmmacMDBForb   0.8766 11\n18     EmmacMDBGwyd   0.9050  9\n19     EmmacMDBMaci   0.8773 10\n20 EmmacMDBMurrMung   0.8890 10\n21     EmmacMDBSanf   0.8914 10\n22    EmmacNormJack   0.8725  6\n23    EmmacNormLeic   0.8863  1\n24    EmmacNormSalt   0.8706  1\n25    EmmacRichCasi   0.8757 10\n26        EmmacRoss   0.8706 10\n27    EmmacRussEube   0.8612 10\n28     EmmacTweeUki   0.8773 10\n29    EmsubRopeMata   0.8345  5\n30    EmvicVictJasp   0.8361  5\n\nListing 20 individuals with the lowest CallRates\n  Use this list to see which individuals will be lost on filtering by individual\n  Set ind.to.list parameter to see more individuals\n   Individual  CallRate\n1    AA063722 0.7490196\n2    AA063726 0.7490196\n3    AA063732 0.7647059\n4    AA063720 0.7686275\n5    AA063712 0.7686275\n6    AA063708 0.7725490\n7    AA063718 0.7764706\n8    AA063710 0.7764706\n9    AA063714 0.7764706\n10   AA063716 0.7803922\n11   AA032760 0.7960784\n12   UC_00210 0.8196078\n13   UC_00259 0.8196078\n14   AA018494 0.8235294\n15   UC_00206 0.8235294\n16   AA019164 0.8274510\n17   UC_00209 0.8313725\n18   UC_00254 0.8313725\n19   AA019159 0.8352941\n20  UC_00126c 0.8352941\n\n)\n\n\n\n\n\nCompleted: gl.report.callrate \n\n\n\n\n\ngl.report.reproducibility(gl)\n\nStarting gl.report.reproducibility \n  Processing genlight object with SNP data\n  Reporting Repeatability by Locus\n  No. of loci = 255 \n  No. of individuals = 250 \n    Minimum      :  0.959459 \n    1st quartile :  1 \n    Median       :  1 \n    Mean         :  0.9981525 \n    3r quartile  :  1 \n    Maximum      :  1 \n    Missing Rate Overall:  0.12 \n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%  1.000000      214    83.9       41    16.1\n2       95%  1.000000      214    83.9       41    16.1\n3       90%  1.000000      214    83.9       41    16.1\n4       85%  1.000000      214    83.9       41    16.1\n5       80%  1.000000      214    83.9       41    16.1\n6       75%  1.000000      214    83.9       41    16.1\n7       70%  1.000000      214    83.9       41    16.1\n8       65%  1.000000      214    83.9       41    16.1\n9       60%  1.000000      214    83.9       41    16.1\n10      55%  1.000000      214    83.9       41    16.1\n11      50%  1.000000      214    83.9       41    16.1\n12      45%  1.000000      214    83.9       41    16.1\n13      40%  1.000000      214    83.9       41    16.1\n14      35%  1.000000      214    83.9       41    16.1\n15      30%  1.000000      214    83.9       41    16.1\n16      25%  1.000000      214    83.9       41    16.1\n17      20%  1.000000      214    83.9       41    16.1\n18      15%  0.997674      217    85.1       38    14.9\n19      10%  0.994536      230    90.2       25     9.8\n20       5%  0.984694      243    95.3       12     4.7\n21       0%  0.959459      255   100.0        0     0.0\nCompleted: gl.report.reproducibility \n\n\n\n\n\ngl.filter.callrate(gl,method =\"ind\", threshold=0.8)\n\nStarting gl.filter.callrate \n  Processing genlight object with SNP data\n  Warning: Data may include monomorphic loci in call rate \n                    calculations for filtering\n  Recalculating Call Rate\n  Removing individuals based on Call Rate, threshold = 0.8 \n  Individuals deleted (CallRate &lt;=  0.8 ):\nAA032760[EmmacMDBMaci], AA063718[EmmacCoopAvin], AA063720[EmmacCoopAvin], AA063722[EmmacCoopAvin], AA063726[EmmacCoopAvin], AA063732[EmmacCoopAvin], AA063708[EmmacCoopAvin], AA063710[EmmacCoopAvin], AA063712[EmmacCoopAvin], AA063714[EmmacCoopAvin], AA063716[EmmacCoopAvin],\n  Summary of filtered dataset\n    Call Rate for individuals &gt; 0.8 \n    Original No. of loci : 255 \n    Original No. of individuals: 250 \n    No. of loci retained: 255 \n    No. of individuals retained: 239 \n    No. of populations:  29 \n\n\n\n\n\n  Note: Locus metrics not recalculated\n  Note: Resultant monomorphic loci not deleted\nCompleted: gl.filter.callrate \n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nRemember, you can always look up the help file for dartRverse functions by putting a question mark (?) before a function. For example: ?gl.filter.callrate\nMake sure you have the associated library loaded (eg. libary(dartR.base))\n\n\nNow, lets take a look at our genetic data before and after filtering using the gl.smearplot() function.\n\ncodeBeforeAfter\n\n\n\ngl &lt;- testset.gl\ngl.smearplot(gl) # Before Filtering\n\ngl &lt;- gl.filter.callrate(gl,verbose=0)\ngl &lt;- gl.filter.callrate(gl, method= \"ind\", \n                         threshold=0.80, verbose=0)\ngl.smearplot(gl) # After Filtering\n\n\n\n\n\n  Processing genlight object with SNP data\nStarting gl.smearplot \n\n\n\n\n\nCompleted: gl.smearplot \n\n\n\n\n\n\n  Processing genlight object with SNP data\nStarting gl.smearplot \n\n\n\n\n\nCompleted: gl.smearplot"
  },
  {
    "objectID": "session01.html#further-study",
    "href": "session01.html#further-study",
    "title": "1  Intro to dartR",
    "section": "Further Study",
    "text": "Further Study\nFor more tuturials see the dartR Tutorials section.\nAnd check out this interesting paper, Jaya et al. (2022).\n\n\n\n\nJaya, Frederick R., Jessie C. Tanner, Michael R. Whitehead, Paul Doughty, J. Scott Keogh, Craig C. Moritz, and Renee A. Catullo. 2022. “Population Genomics and Sexual Signals Support Reproductive Character Displacement in Uperoleia (Anura: Myobatrachidae) in a Contact Zone.” Molecular Ecology 31 (17): 4527–43. https://doi.org/10.1111/mec.16597."
  },
  {
    "objectID": "session02.html#required-packages",
    "href": "session02.html#required-packages",
    "title": "2  Pop Gen In Conservation",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\nlibrary(dartR.data)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session02.html#session-content",
    "href": "session02.html#session-content",
    "title": "2  Pop Gen In Conservation",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session02.html#exercise",
    "href": "session02.html#exercise",
    "title": "2  Pop Gen In Conservation",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session02.html#further-study",
    "href": "session02.html#further-study",
    "title": "2  Pop Gen In Conservation",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session03.html#required-packages",
    "href": "session03.html#required-packages",
    "title": "3  Sequencing Technologies",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session03.html#session-content",
    "href": "session03.html#session-content",
    "title": "3  Sequencing Technologies",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session03.html#exercise",
    "href": "session03.html#exercise",
    "title": "3  Sequencing Technologies",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session03.html#further-study",
    "href": "session03.html#further-study",
    "title": "3  Sequencing Technologies",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session04.html#required-packages",
    "href": "session04.html#required-packages",
    "title": "4  Data Management, Reproducibility & Integrity",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session04.html#session-content",
    "href": "session04.html#session-content",
    "title": "4  Data Management, Reproducibility & Integrity",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session04.html#exercise",
    "href": "session04.html#exercise",
    "title": "4  Data Management, Reproducibility & Integrity",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session04.html#further-study",
    "href": "session04.html#further-study",
    "title": "4  Data Management, Reproducibility & Integrity",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session05.html#required-packages",
    "href": "session05.html#required-packages",
    "title": "5  Effective Population Size",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\nlibrary(ggplot2)\n# library(geohippos) # Oh package, Where Art Thou?\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session05.html#session-content",
    "href": "session05.html#session-content",
    "title": "5  Effective Population Size",
    "section": "Session Content",
    "text": "Session Content\n\nIntroduction\nNe is important for conservation and management of populations. It is an indicator of the genetic diversity of a population and is used to estimate the probability of extinction.\nEffective population size (Ne) is a concept in population genetics that refers to the number of breeding individuals in an idealized population that would show the same amount of genetic drift or inbreeding or linkage disequilbrium or coalescent as the population under study. Unlike the actual census size (Nc), which counts all individuals within a population, Ne focuses on those contributing genes to the next generation, offering a more precise understanding of a population’s genetic health and potential for evolutionary change.\nThe 50/500 rule is a guideline in conservation biology that relates to the effective population size (Ne) and its implications for the conservation of species. This rule was first proposed by Franklin in 1980 and later expanded by Soule in 1986. It serves as a rule of thumb for determining the minimum viable population sizes needed to prevent inbreeding depression in the short term and maintain evolutionary potential over the long term.\nBe aware the 50/500 rule is a rule of thumb and should be used with caution. It is not a one-size-fits-all rule and should be used in conjunction with other information about the species and its habitat. It has been criticized for being too simplistic and not taking into account the specific needs of individual species.\n\n\n1. Current effective population size\nCarlo\n\n\n2. Historic effective population size\n\n2a Based on SFS\nThe Site Frequency Spectrum (SFS), sometimes referred to as the allele frequency spectrum, is a fundamental concept in population genetics that describes the distribution of allele frequencies at polymorphic sites within a sample of DNA sequences from a population. It provides a powerful summary of the genetic variation present in the population, capturing information about the history of mutations, demographic events (such as population expansions or bottlenecks). There are several methods to estimate historic, but we explore only two here: Epos (lynch2019?) and Stairways2 (liu2020?)\n\n\nThe SFS\nIt is straight forward to create the sfs from a genlight/dartR object. But first you want to make sure you do not have missing data in your dataset, because the allele frequency spectrum is sensitive to missing data.\n\n# Load the data\ngl100 &lt;- readRDS(\"./data/slim_100.rds\")\n# check the population size and number of populations\ntable(pop(gl100))\n# number of individuals\nnInd(gl100)\n# number of loci\nnLoc(gl100)\n\n# create\nsfscon &lt;- gl.sfs(gl100, folded = TRUE)\nsfscon\n\nAs you can see the is simply a table of the number of alleles at each frequency. Be aware the the sfs is folded by default, but you can change this with the argument folded = FALSE. In most of the cases we will use the folded=TRUE option as you need phased data to use the unfolded sfs (and also have an idea which state is the ancestral one. Often the genomic of an ancestral outgroup is used for this information).\n\n# unfolded sfs\nun.sfs &lt;- gl.sfs(gl100, folded = FALSE)\nun.sfs\n\nIn addition it is possible to create multidimensional sfs, which is useful for example when you have multiple populations (in case you want to have that use: singlepop=FALSE). Be aware if you want to create and multidimensional sfs from more than say 3 populations a 30 individuals you create a huge array of dimensions (61 x 61 x 61), with mainly zeros. So often multidemensional sfs are not very useful."
  },
  {
    "objectID": "session05.html#exercise",
    "href": "session05.html#exercise",
    "title": "5  Effective Population Size",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session05.html#further-study",
    "href": "session05.html#further-study",
    "title": "5  Effective Population Size",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session06.html#required-packages",
    "href": "session06.html#required-packages",
    "title": "6  Management of Small Populations",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session06.html#session-content",
    "href": "session06.html#session-content",
    "title": "6  Management of Small Populations",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session06.html#exercise",
    "href": "session06.html#exercise",
    "title": "6  Management of Small Populations",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session06.html#further-study",
    "href": "session06.html#further-study",
    "title": "6  Management of Small Populations",
    "section": "Further Study",
    "text": "Further Study\nstill to come…\nfile.copy(from = ‘.’)\nfile.copy(from = paste0(mediaDir, media_mp3), to = paste0(“./_audio/”, media_mp3))"
  },
  {
    "objectID": "session07.html#required-packages",
    "href": "session07.html#required-packages",
    "title": "7  Natural Selection",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session07.html#session-content",
    "href": "session07.html#session-content",
    "title": "7  Natural Selection",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session07.html#exercise",
    "href": "session07.html#exercise",
    "title": "7  Natural Selection",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session07.html#further-study",
    "href": "session07.html#further-study",
    "title": "7  Natural Selection",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session08.html#introduction",
    "href": "session08.html#introduction",
    "title": "8  Landscape Genetics",
    "section": "Introduction",
    "text": "Introduction\nLandscape genetics combines landscape ecology with population genetics to understand how the structure, composition and configuration of the landscape affects gene flow, genetic drift, and selection.\nIn this tutorial, we will dive into the first question - how does the landscape influence gene flow? There are many ways to tackle this question, for example, we can explore gene flow at the individual or population level, over different spatial scales, and/or across a meta-population.\nHere we’ll start with the basics, by looking at the spatial distribution of individuals, and build on this until we incorporate landscape features, to understand:\n\nDifferent dispersal strategies; and\nLimitations to gene flow, including:\na) Geographic distance (isolation-by-distance);\nb) Geographic barriers (isolation-by-barrier);\nc) Landscape attributes (isolation-by-resistance)."
  },
  {
    "objectID": "session08.html#dispersal-strategies",
    "href": "session08.html#dispersal-strategies",
    "title": "8  Landscape Genetics",
    "section": "1. Dispersal strategies",
    "text": "1. Dispersal strategies\nMany biological and demographic processes can shape patterns of genetic structure, for example, dispersal strategies, mating systems, and social behaviours. These processes often occur over a fine scale. As such, exploring patterns within populations over 10s-100s of metres is often very informative, especially in small and inconspicuous species.\nBefore diving into more complex and correlative analyses, it is useful to understand some of the baseline life-history and demographic traits in your species. One common question is: how far do individuals disperse and is this the same or different for males and females?\nWhen one sex disperses further than the other, this is known as sex-biased dispersal. This can be detected via genetic spatial autocorrelation analysis. We’ll describe this in more detail later on, but in short, increased philopatry by one sex results in greater genetic similarity among neighbouring individuals, while genetic similarity is reduced in the dispersing sex. You can also learn more about it in Banks & Peakall 2012 (and references therein).\n\n\n\n\n\n\nWhat is philopatry?\n\n\n\nNatal philopatry describes when an animal remains close or returns to the area where they were born.\n\n\nTo explore the genetic patterns that result from sex-biased dispersal, we’re going to simulate this process in a hypothetical animal population. First, we need to set up the dispersal kernels, using the custom function below.\n\n# Create a function, where: \n# x = minimum to maximum distance, \n# d0 = mean distance, \n# p= proportion  that go to mean\np2p &lt;- function(x, d0, p)\n{\n  return (exp(((x/d0)*log(p))))\n}\n\n# Dispersal kernels:\n# Females\ndispfemale &lt;- (p2p(x = 1:50, # range of distances\n                   d0 = 1, # mean dispersal distance\n                   p = 0.5)) # proportion that go to mean\npdispfemale &lt;- c(0, cumsum(dispfemale)/sum(dispfemale))\n\n# Males\ndispmale &lt;- (p2p(x = 1:50, # range of distances\n                 d0 = 20, # mean dispersal distance\n                 p = 0.5)) # proportion that go to mean\npdispmale &lt;- c(0, cumsum(dispmale)/sum(dispmale))\n\nLet’s look at the dispersal curves. In this case, males disperse further than females (i.e., there is male-biased dispersal):\n\ncodeFemale dispersalMale dispersal\n\n\n\n# Plot\nplot(dispfemale, \n     type = \"l\",      # plot line\n     col = '#E69F00', # line colour\n     lwd = 2,\n     main = \"Female dispersal curve\", \n     xlab = \"Distance (m)\", \n     ylab = \"\")\nplot(dispmale,\n     type = \"l\",      # plot line\n     col = '#5D3FD3', # line colour\n     lwd = 2,         \n     main = \"Male dispersal curve\", \n     xlab = \"Distance (m)\", \n     ylab = \"\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNext we’ll create a function that generates a population using glSim, which simulates simple SNP data and returns a genlight object. In our hypothetical population, females randomly mate with the nearest male, produce two offspring at a 50:50 sex-ratio, and the offspring then disperse following the dispersal probabilities created above.\n\n# Create a function, where: Nind = number of individuals, Nsnp = number\n# of SNPs, pdispF = female dispersal probability (generated above)\n# pdispM = male dispersal probability (generated above) seed = set the\n# seed so simulation is repeatable\nSimDisp &lt;- function(Nind, Nsnp, pdispF, pdispM, seed) {\n\n    set.seed(seed)\n\n    # Simulate a genlight object\n    gg &lt;- glSim(n.ind = Nind, n.snp.nonstruc = Nsnp, grp.size = c(0.999,\n        0.001), ploidy = 2, k = 1, LD = FALSE, ind.names = paste(sprintf(\"ind%03d\",\n        1:Nind), sep = \"\"), snp.names = paste(sprintf(\"snp%03d\", 1:Nsnp),\n        sep = \"\"))\n\n    # Define pop\n    pop(gg) &lt;- rep(\"A\", Nind)\n\n    # Create all the other parameters\n    gg &lt;- gl.compliance.check(gg)\n\n    # Define sex using a sex ratio of 0.5\n    ds &lt;- c(rep(\"F\", 0.5 * Nind), rep(\"M\", (1 - 0.5) * Nind))\n    ds &lt;- ds[order(runif(length(ds)))]\n    gg@other$ind.metrics$sex &lt;- factor(ds)\n\n    # Set coordinates\n    xy &lt;- expand.grid(x = 1:100, y = 1:100)\n    # sample from the grid\n    xys &lt;- xy[sample(1:nrow(xy), Nind, replace = FALSE), ]\n    gg@other$ind.metrics$x &lt;- xys$x\n    gg@other$ind.metrics$y &lt;- xys$y\n\n    for (ii in 1:20) {\n        # Run for 20 generations\n\n        # Find mating pairs & reproduce\n        females &lt;- which(gg@other$ind.metrics$sex == \"F\")\n        males &lt;- which(gg@other$ind.metrics$sex == \"M\")\n\n        off &lt;- list()\n\n        for (i in 1:length(females)) {\n            mfemale &lt;- gg[females[i], ]\n            fxy &lt;- c(gg@other$ind.metrics$x[females[i]], gg@other$ind.metrics$y[females[i]])\n            mxy &lt;- cbind(gg@other$ind.metrics$x[males], gg@other$ind.metrics$y[males])\n            xxyy &lt;- rbind(fxy, mxy)\n\n            # Find closest mating male\n            chosenm &lt;- which.min(as.matrix(dist(xxyy))[1, -1])\n            mmale &lt;- gg[males[chosenm], ]\n\n            doff &lt;- gl.sim.offspring(mmale, mfemale, sexratio = 0.5, noffpermother = 2)  # 2 offspring\n            doff@other$ind.metrics &lt;- data.frame(sex = factor(c(\"F\", \"M\")),\n                x = mfemale@other$ind.metrics$x, y = mfemale@other$ind.metrics$y)\n\n            off[[i]] &lt;- doff\n\n        }\n\n        gg &lt;- do.call(rbind, off)\n\n        # Make all offspring adults\n        xx &lt;- (lapply(off, function(x) x@other$ind.metrics))\n        xx &lt;- do.call(rbind, xx)\n        gg@other$ind.metrics &lt;- xx\n\n        # Emigrate depending on dispersial distance\n\n        for (i in 1:nInd(gg)) {\n\n            # Use dispersal curves generated above to determine\n            # distance\n            if (gg@other$ind.metrics$sex[i] == \"M\")\n                dis &lt;- max(which(runif(1) &gt; pdispM)) else dis = max(which(runif(1) &gt; pdispF))\n\n            # Dispersal direction\n            dir &lt;- runif(1, 0, 2 * pi)\n\n            # Assign new coordinates\n            gg@other$ind.metrics$x[i] &lt;- gg@other$ind.metrics$x[i] + dis *\n                cos(dir)\n            gg@other$ind.metrics$y[i] &lt;- gg@other$ind.metrics$y[i] + dis *\n                sin(dir)\n        }\n\n        # Use torus to determine what to do with individuals that\n        # disperse outside of extent\n        gg@other$ind.metrics$x &lt;- gg@other$ind.metrics$x%%100\n        gg@other$ind.metrics$y &lt;- gg@other$ind.metrics$y%%100\n\n        # Plot\n        plot(gg@other$ind.metrics$x, gg@other$ind.metrics$y, pch = 16, cex = 1,\n            col = c(\"#E69F00\", \"#5D3FD3\")[as.numeric(gg@other$ind.metrics$sex)],\n            asp = 1, main = paste(\"Generation\", ii), xlab = \"x\", ylab = \"y\")\n        legend(\"bottomleft\", legend = c(\"Female\", \"Male\"), col = c(\"#E69F00\",\n            \"#5D3FD3\"), pch = 16, cex = 1)\n\n    }\n\n    # Output genlight object containing simulated data\n    return(gg)\n}\n\nNow run the function to simulate a population with 100 individuals, 1000 SNPs, and male-biased dispersal.\n\n\n\n\n\n\nNote\n\n\n\nThe simulation goes for 20 generations - you can see an animation below\n\n\n\nsimdat &lt;- SimDisp(Nind = 100, Nsnp = 1000, pdispF = pdispfemale, pdispM = pdispmale,\n    seed = 123)\n\n\n\n\nWhat does this mean for fine-scale genetic structure? Can we identify different dispersal patterns for males and females? Let’s run genetic spatial autocorrelation to find out. We’ll use the function gl.spatial.autoCorr. This is a multivariate approach that combines all loci into a single analysis (Smouse & Peakall 1999; Peakall et al. 2003; Banks & Peakall 2012). The autocorrelation coefficient “r” is calculated for each pair of individuals in each specified distance class (called “bins” in this function).\nWe’ll use evenly distributed bins and compare individuals at 10 m intervals up to 50 m.\n\n\n\n\n\n\nSignificance testing\n\n\n\nThere are two ways to test whether fine-scale genetic structure is significantly positive (i.e., individuals are genetically similar) or negative (i.e., individuals are genetically dissimilar).\nThe first approach is a one-tail permutation test, which provides 95% null hypothesis confidence regions. If the autocorrelation coefficient “r” falls outsdide of this range, significant fine-scale spatial genetic structure has been detected.\nThe second approach is to estimate 95% bootstrap confidence intervals (CIs) around the value for r. These are obtained by drawing (with replacement) from within the set of relevant pairwise comparisons for a given distance class. If bootstrap CIs overlap zero, there is no fine-scale spatial genetic structure present. Bootstrap CIs also allow you to test for significant differences between groups (e.g., between females and males). When CIs are non-overlapping, there is a significant difference.\nI tend to use 95% bootstrap CIs, since they are more conservative than permutational tests and allow for comparisons. The gl.spatial.autoCorr function below will output 95% bootstrap CIs. You can try a permutation test by adding permutation = TRUE (note that for this option to work, you will need to create separate plots for each sex by choosing plot.pops.together = FALSE).\n\n\n\n# Make 'sex' the population name\npop(simdat) &lt;- simdat@other$ind.metrics$sex\n\n# Add xy coordinates to the 'other' slot in genlight\nsimdat@other$latlon &lt;- data.frame(lon = simdat@other$ind.metrics$x, lat = simdat@other$ind.metrics$y)\nsimdat@other$latlon &lt;- Mercator(simdat@other$latlon, inverse = T)\n\n# Run genetic spatial autocorrelation\ngl.spatial.autoCorr(simdat, bins = seq(0, 50, 10), plot.pops.together = TRUE,\n    plot.colors.pop = c(\"#E69F00\", \"#5D3FD3\"))\n\n\n\n\nWe can see that:\n\nBoth females and males show significant positive spatial autocorrelation up to 30 m (where confidence intervals overlap zero). In other words, once you start comparing individuals that are 30 m apart, they are unlikely to be related/genetically similar (regardless of sex).\nFemales have significantly stronger fine-scale genetic structure than males up to 10 m (i.e., a greater “r” value and female and male bootstrap CIs are non-overlapping).\n\nThese results are not surprising, since we set our distance classes based on the known (simulated) dispersal capacity of males and females, and we had large sample sizes (both individuals and loci). In reality, this analysis is a careful balance between power (maximising the sample size in each bin), and ensuring you are looking at the right scale (i.e., the size of the distance class).\n\n\n\n\n\n\nExercise\n\n\n\n\nWhat happens when you vary the dispersal distances? Can you pick up small differences between the sexes?\nWhat happens if you change the number of individuals or SNPs? Does this influence the sensitivity of the analysis? Which is more important - more individuals or more loci?\nWhat happens when you vary the size and number of distance classes? How does this interact with sample size? What do you think would happen if you used a single 50 m distance class - do we still see the signal of male-biased dispersal?\n\n\n\n\n\n\n\n\n\nRe-run the code from the beginning\n\n\n\nTry varying the following parameters:\n\nDispersal curves: “d0” and “p” when running the p2p function\nSample sizes: “Nind” (number of individuals) and “Nsnp” (number of loci) when running the SimDisp function\nDistance classes: “bins” when running the gl.spatial.autoCorr function"
  },
  {
    "objectID": "session08.html#a.-isolation-by-distance",
    "href": "session08.html#a.-isolation-by-distance",
    "title": "8  Landscape Genetics",
    "section": "2a. Isolation-by-distance",
    "text": "2a. Isolation-by-distance\nIsolation-by-distance (IBD) is a key concept in population genetics. It describes a simple idea: that geographic distance can influence gene flow because individuals or populations that are geographically distant from each other are less likely to share genetic material than those that are close (based on the “stepping-stone” model; Kimura & Weiss 1964).\nWe can test for IBD with Mantel tests of matrix correspondence (Mantel 1967), implemented using the function gl.ibd. This test compares pairwise geographic and genetic distance matrices, using permutations to test for significance. For the latter, you can use pairwise population FST values or individual-by-individual genetic distances.\nIt’s easy enough to plot the relationship between geographic and genetic distance. However, we can’t use a standard regression to test this relationship because pairwise data are not independent. Mantel tests solve this problem by using permutation to test for significance (e.g., the data are randomly shuffled, and if there is no relationship, the result will be similar).\n\n\n\n\n\n\nPopulations vs. individuals\n\n\n\nIBD tests often use pairwise population metrics like FST. This is useful when there are lots of samples and populations are well defined. However, there are often situations where we don’t have multiple samples per location, populations are difficult to define and/or individuals are more continuously distributed. In this case, we can use the individual as the unit of analysis.\nWhere FST estimates represent evolutionary averages, pairwise individual genetic distances may represent more contemporary patterns of dispersal. Therefore, the approach you take depends on the species, your sampling, and the question you want to ask.\n\n\nLet’s test for IBD in our simulated data set:\n\ntotal.ibd &lt;- gl.ibd(simdat, distance = \"euclidean\", coordinates = \"latlon\")\n\n\n\n\n\n# Show Mantel statistics\ntotal.ibd$mantel\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = Dgen, ydis = Dgeo, permutations = permutations,      na.rm = TRUE) \n\nMantel statistic r: 0.08552 \n      Significance: 0.013 \n\nUpper quantiles of permutations (null model):\n   90%    95%  97.5%    99% \n0.0512 0.0634 0.0767 0.0866 \nPermutation: free\nNumber of permutations: 999\n\n\nThere is significant IBD across all individuals, but it’s not very pronounced. Can we still see the signal of male-biased dispersal? Let’s create separate IBD plots for females and males:\n\nf.ibd &lt;- gl.ibd(simdat[simdat@pop == \"F\"], distance = \"euclidean\", coordinates = \"latlon\")\n\n\n\nm.ibd &lt;- gl.ibd(simdat[simdat@pop == \"M\"], distance = \"euclidean\", coordinates = \"latlon\")\n\n\n\n\n\n# Show Mantel statistics for females\nf.ibd$mantel\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = Dgen, ydis = Dgeo, permutations = permutations,      na.rm = TRUE) \n\nMantel statistic r: 0.1438 \n      Significance: 0.014 \n\nUpper quantiles of permutations (null model):\n   90%    95%  97.5%    99% \n0.0828 0.1053 0.1302 0.1476 \nPermutation: free\nNumber of permutations: 999\n\n# Show Mantel statistics for males\nm.ibd$mantel\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = Dgen, ydis = Dgeo, permutations = permutations,      na.rm = TRUE) \n\nMantel statistic r: 0.02018 \n      Significance: 0.375 \n\nUpper quantiles of permutations (null model):\n   90%    95%  97.5%    99% \n0.0825 0.1027 0.1199 0.1514 \nPermutation: free\nNumber of permutations: 999\n\n\nYes - we see significant IBD in females, since dispersal is more restricted. Males show no pattern of IBD, since many individuals can disperse right up to the spatial extent of our sampling. However, we lose some of the nuance from the previous analysis.\n\n\n\n\n\n\nWhat can we learn from each analysis?\n\n\n\nMantel tests show us the broad trend across our study. IBD often acts as our null hypothesis (along with panmixia - i.e., random mating and dispersal) against which to test further landscape genetic analyses. However, unless the signal of sex-biased dispersal is very strong across the whole dataset, a Mantel test is unlikely to detect it. Spatial autocorrelation analysis is usually more powerful in detecting fine-scale genetic patterns than Mantel tests, because samples are “binned” and genetic structure is explored across multiple distance classes.\n\n\n\n\n\n\n\n\nExercise\n\n\n\n1. What happens if you use the proportion of shared alleles instead of euclidean distance?\n\n\nIn general, we expect a linear relationship between geographic (sometimes log-transformed) and genetic distance. A discontinuous relationship can be an indication that something else is going on. We will explore this idea below using a real example.\n\nLesser hairy-footed dunnarts in the Pilbara\n\n\n\nSminthopsis youngsonii\n\n\n\n\nLoad the data\n\nload(\"Data/Sy.gl.RData\")  # genetic data\n\nSminthopsis youngsonii (or the lesser hairy footed dunnart), is a small carnivouros dasyurid found across the Australian arid region. As the name suggests, their hind foot is covered in short, bristly hairs, which are thought to help them navigate sandy soils. They are usually found on sand dunes, inter dune swale and red sand plains.\nThese samples were taken in the Pilbara at the very western edge of their range. Let’s take a look at a map:\n\nleaflet(Sy.gl@other$latlong) %&gt;%\n    addTiles() %&gt;%\n    addCircleMarkers(lng = ~lon, lat = ~lat, popup = ~htmlEscape(lon))\n\n\n\n\n\nGiven this is the edge of their range, and the Pilbara is quite rocky and doesn’t harbour much of the ideal habitat for this species, we want to know a little more about dispersal and connectivity in this area. A good first step is to test for isolation by distance.\n\nSy.ibd &lt;- gl.ibd(Sy.gl, distance = \"euclidean\")\n\n\n\n\n\n# Show Mantel statistics\nSy.ibd$mantel\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = Dgen, ydis = Dgeo, permutations = permutations,      na.rm = TRUE) \n\nMantel statistic r: 0.6513 \n      Significance: 0.001 \n\nUpper quantiles of permutations (null model):\n   90%    95%  97.5%    99% \n0.0613 0.0897 0.1204 0.1594 \nPermutation: free\nNumber of permutations: 999\n\n\nYes - there is significant IBD! The pattern is very strong. But… some of the points don’t seem to follow the same slope? Why might this be?\nThere seems to be a big gap in sampling. This could be due to a sampling bias (e.g., the missing area is difficult to get to). Alternatively, the species may not occur here, suggesting there might be something going on with the habitat.\n\n\n\n\n\n\nGiven what we know about the species, what would be a reasonable hypothesis?\n\n\n\nCould substrate be driving this sampling gap and the strange IBD pattern?\n\n\nLet’s separate the individuals into two populations using longitude. You can click on the points in the map above to choose a location.\n\n# Choose a point that separates the samples into two populations\nlon.break &lt;- 114.87\n# Assign eastern and western populations based on this point\nSy.gl@pop &lt;- as.factor(ifelse(Sy.gl@other$latlong$lon &lt; lon.break, \"1.West\",\n    \"2.East\"))\n\nNow let’s take another look at IBD, but this time we’ll include the population information.\n\ngl.ibd(Sy.gl, distance = \"euclidean\", paircols = \"pop\")\n\n\n\n\nIt looks like the magnitude of genetic distance is different and there are two different slopes describing IBD within each ‘population’. The points with large geographic and genetic distances represent among population comparisons. Discontinuities like this can sometimes suggest a barrier to gene flow. Let’s take a look at the substrate.\n\n# Load a soil shapefile\nsoil &lt;- st_read(\"Data/Soil.shp\")  # spatial data\n\n# Create a colour palette for the two populations\npop.pal &lt;- colorFactor(palette = c(\"#F8766D\", \"#00BFC4\"), domain = Sy.gl@pop)\n\n# Create a palette\nsoil.pal &lt;- colorFactor(palette = c(\"#9C640C\", \"#5c3001\", \"#C0392B\", \"#EDC001\",\n    \"#FDEFB2\"), domain = soil$Type)\n\n\n# Generate another map\nleaflet(cbind(pop = Sy.gl@pop, Sy.gl@other$latlong)) %&gt;%\n    addTiles() %&gt;%\n    addPolygons(data = soil, weight = 0, fillOpacity = 0.7, color = ~soil.pal(Type)) %&gt;%\n    addCircleMarkers(lng = ~lon, lat = ~lat, color = ~pop.pal(pop)) %&gt;%\n    addLegendFactor(pal = soil.pal, shape = \"rect\", fillOpacity = 0.7, opacity = 0,\n        values = ~soil$Type, title = \"Soil type\", position = \"topright\",\n        data = gadmCHE, group = \"Polygons\")\n\n\n\n\n\nIt looks like clay could be acting as a barrier. This is a good theory, but it would be useful to be able to visualise these patterns of isolation by distance spatially to get an indication of where exactly gene flow is being restricted. We’ll explore this idea in the next section."
  },
  {
    "objectID": "session08.html#b.-isolation-by-barrier",
    "href": "session08.html#b.-isolation-by-barrier",
    "title": "8  Landscape Genetics",
    "section": "2b. Isolation-by-barrier",
    "text": "2b. Isolation-by-barrier\nUp to this point, we’ve tested for IBD - but could be helpful to visually inspect patterns of IBD across the landscape. We can do this with EEMS…"
  },
  {
    "objectID": "session08.html#c.-isolation-by-resistance",
    "href": "session08.html#c.-isolation-by-resistance",
    "title": "8  Landscape Genetics",
    "section": "2c. Isolation-by-resistance",
    "text": "2c. Isolation-by-resistance\nUp to this point, we’ve only visually inspected the landscape, could be useful to explicitly test the correlation between gene flow and landscape features."
  },
  {
    "objectID": "session08.html#further-study",
    "href": "session08.html#further-study",
    "title": "8  Landscape Genetics",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session09.html#required-packages",
    "href": "session09.html#required-packages",
    "title": "9  Lineage Divergence",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session09.html#session-content",
    "href": "session09.html#session-content",
    "title": "9  Lineage Divergence",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session09.html#exercise",
    "href": "session09.html#exercise",
    "title": "9  Lineage Divergence",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session09.html#further-study",
    "href": "session09.html#further-study",
    "title": "9  Lineage Divergence",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session10.html",
    "href": "session10.html",
    "title": "10  Sex Linked Markers",
    "section": "",
    "text": "11 Further study\nDevloo-Delva, F., Burridge, C. P., Kyne, P. M., Brunnschweiler, J. M., Chapman, D. D., Charvet, P., … & Feutry, P. (2023). From rivers to ocean basins: The role of ocean barriers and philopatry in the genetic structuring of a cosmopolitan coastal predator. Ecology and Evolution, 13(2), e9837. https://doi.org/10.1002/ece3.9837\nNikolic, N., Devloo-Delva, F., Bailleul, D., Noskova, E., Rougeux, C., Delord, C., … & Arnaud‐Haond, S. (2023). Stepping up to genome scan allows stock differentiation in the worldwide distributed blue shark Prionace glauca. Molecular Ecology, 32(5), 1000-1019. https://doi.org/10.1111/mec.16822\nRobledo-Ruiz, D. A., Austin, L., Amos, J. N., Castrejón-Figueroa, J., Harley, D. K. P., Magrath, M. J. L., Sunnucks, P., & Pavlova, A. (2023). Easy-to-use R functions to separate reduced-representation genomic datasets into sex-linked and autosomal loci, and conduct sex assignment. Molecular Ecology Resources, 00, 1–21. https://doi.org/10.1111/1755-0998.13844"
  },
  {
    "objectID": "session10.html#load-data",
    "href": "session10.html#load-data",
    "title": "10  Sex Linked Markers",
    "section": "Load data",
    "text": "Load data\n\ndata(\"YTH\")\nYTH  # Explore the dataset\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  994 SNPs , size: 49.9 Mb\n\n    missing data: 139174 (=22.99 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  994 locus labels\n   @loc.all:  994 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nYTH@n.loc  # Number of SNPs\n\n[1] 994\n\nlength(YTH@ind.names)  # Number of individuals\n\n[1] 609"
  },
  {
    "objectID": "session10.html#run-filter.sex.linked",
    "href": "session10.html#run-filter.sex.linked",
    "title": "10  Sex Linked Markers",
    "section": "Run filter.sex.linked",
    "text": "Run filter.sex.linked\nThis function identifies sex-linked and autosomal loci present in a SNP dataset (i.e., genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\nThe genlight object must contain in gl@other$ind.metrics a column named “id”, and a column named “sex” in which individuals with known-sex are assigned ‘M’ for male, or ‘F’ for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\n\nZW/ZZ sex chromosomes\n\n\n\nNOTE\nSet ncores to more than 1 (default) if you have more than 50,000 SNPs, since it could actually slow down the analysis with smaller datasets.\n\n\nknitr::kable(head(YTH@other$ind.metrics))  # Check that ind.metrics has the necessary columns\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\npop\nsex\nsex_original\nservice\nplate_location\n\n\n\n\nANWC46839\nANWC46839\nMelanops\nF\nF\nDLich17-2918\n1-A1\n\n\nW49\nW49\nCassidix\nF\nF\nDLich17-2918\n1-A10\n\n\nW90\nW90\nCassidix\nF\nF\nDLich17-2918\n1-A12\n\n\nC25\nC25\nCassidix\nM\nM\nDLich17-2918\n1-A2\n\n\nC8\nC8\nCassidix\nM\nM\nDLich17-2918\n1-A3\n\n\nW70\nW70\nCassidix\nF\nF\nDLich17-2918\n1-A4\n\n\n\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = YTH, system = \"zw\")\n\nDetected 276 females and 333 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 994.\nFound 506 sex-linked loci:\n   52 W-linked loci\n   273 sex-biased loci\n   165 Z-linked loci\n   16 ZW gametologs.\nAnd 488 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nHow many males and females does the dataset contain?\nHow many sex-linked loci were found?\n\n\nNow check the output:\n\nres$w.linked  # Notice that it says 'w-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  52 SNPs , size: 48.9 Mb\n\n    missing data: 17304 (=54.64 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  52 locus labels\n   @loc.all:  52 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$z.linked  # Notice that it says 'z-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  165 SNPs , size: 48.9 Mb\n\n    missing data: 2990 (=2.98 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  165 locus labels\n   @loc.all:  165 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$gametolog\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  16 SNPs , size: 48.8 Mb\n\n    missing data: 580 (=5.95 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  16 locus labels\n   @loc.all:  16 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$sex.biased\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  273 SNPs , size: 49.2 Mb\n\n    missing data: 46048 (=27.7 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  273 locus labels\n   @loc.all:  273 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$autosomal\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  488 SNPs , size: 49.4 Mb\n\n    missing data: 72252 (=24.31 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  488 locus labels\n   @loc.all:  488 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nknitr::kable(head(res$results.table))  # The output table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nindex\ncount.F.miss\ncount.M.miss\ncount.F.scored\ncount.M.scored\nratio\np.value\np.adjusted\nscoringRate.F\nscoringRate.M\nw.linked\nsex.biased\ncount.F.het\ncount.M.het\ncount.F.hom\ncount.M.hom\nstat\nstat.p.value\nstat.p.adjusted\nheterozygosity.F\nheterozygosity.M\nz.linked\nzw.gametolog\n\n\n\n\n27382025-26-T/C\n1\n61\n25\n215\n308\n3.4882302\n0.0000003\n0.0000016\n0.7789855\n0.9249249\nFALSE\nTRUE\n0\n73\n215\n235\nNA\nNA\nNA\n0.0000000\n0.2370130\nFALSE\nFALSE\n\n\n27338005-34-A/G\n2\n12\n13\n264\n320\n1.1186728\n0.8390268\n1.0000000\n0.9565217\n0.9609610\nFALSE\nFALSE\n0\n144\n264\n176\n0.0046581\n0.0000000\n0.0000000\n0.0000000\n0.4500000\nTRUE\nFALSE\n\n\n27331627-16-T/G\n3\n108\n159\n168\n174\n0.7039235\n0.0334301\n0.0860868\n0.6086957\n0.5225225\nFALSE\nFALSE\n0\n2\n168\n172\n0.5128690\n1.0000000\n1.0000000\n0.0000000\n0.0114943\nFALSE\nFALSE\n\n\n53948461-35-G/A\n4\n46\n64\n230\n269\n0.8408645\n0.4593502\n0.7791707\n0.8333333\n0.8078078\nFALSE\nFALSE\n29\n27\n201\n242\n1.2924846\n0.3950852\n0.9051780\n0.1260870\n0.1003717\nFALSE\nFALSE\n\n\n27360874-8-A/G\n5\n41\n63\n235\n270\n0.7480768\n0.1956613\n0.4120495\n0.8514493\n0.8108108\nFALSE\nFALSE\n25\n38\n210\n232\n0.7272744\n0.2807852\n0.7009152\n0.1063830\n0.1407407\nFALSE\nFALSE\n\n\n27377678-32-C/A\n6\n30\n33\n246\n300\n1.1084581\n0.7894511\n1.0000000\n0.8913043\n0.9009009\nFALSE\nFALSE\n3\n6\n243\n294\n0.6054740\n0.5234966\n1.0000000\n0.0121951\n0.0200000\nFALSE\nFALSE\n\n\n\n\n\nThe output consists of a genlight object for each type of loci, plus a results table."
  },
  {
    "objectID": "session10.html#run-infer.sex",
    "href": "session10.html#run-infer.sex",
    "title": "10  Sex Linked Markers",
    "section": "Run infer.sex",
    "text": "Run infer.sex\nThis function uses the complete output of function filter.sex.linked (list of 6 objects) to infer the sex of all individuals in the dataset. Specifically, the function uses 3 types of sex-linked loci (W-/Y-linked, Z-/X-linked, and gametologs), assigns a preliminary genetic sex for each type of sex-linked loci available, and outputs an agreed sex.\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"zw\",\n    seed = 124)\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nw.linked.sex\n#missing\n#called\nz.linked.sex\n#Hom.z\n#Het.z\ngametolog.sex\n#Hom.g\n#Het.g\nagreed.sex\n\n\n\n\nANWC46839\nANWC46839\nF\n51\n1\nF\n1\n141\nF\n5\n0\nF\n\n\nW49\nW49\nF\n52\n0\nF\n2\n156\nF\n5\n0\nF\n\n\nW90\nW90\nF\n48\n4\nF\n0\n162\nF\n5\n0\nF\n\n\nC25\nC25\nM\n0\n52\nM\n52\n113\nM\n0\n5\nM\n\n\nC8\nC8\nM\n0\n52\nM\n48\n116\nM\n0\n5\nM\n\n\nW70\nW70\nF\n49\n3\nF\n0\n152\nF\n5\n0\nF\n\n\n\n\n\n\nIMPORTANT We created this function with the explicit intent that a human checks the evidence for the agreed sex that do NOT agree for all types of sex-linked loci (denoted as ‘*M’ or ‘*F’). This human can then use their criterion to validate these assignments.\n\n\n\n\n\n\n\nExercise\n\n\n\n\nCan you find individuals for which the agreed sex is uncertain (i.e., has an asterisk “*”)?"
  },
  {
    "objectID": "session10.html#load-data-1",
    "href": "session10.html#load-data-1",
    "title": "10  Sex Linked Markers",
    "section": "Load data",
    "text": "Load data\n\ndata(\"LBP\")\nLBP  # Explore the dataset\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1,000 SNPs , size: 5.2 Mb\n\n    missing data: 20670 (=5.5 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1000 locus labels\n   @loc.all:  1000 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nLBP@n.loc  # Number of SNPs\n\n[1] 1000\n\nlength(LBP@ind.names)  # Number of individuals\n\n[1] 376"
  },
  {
    "objectID": "session10.html#run-filter.sex.linked-1",
    "href": "session10.html#run-filter.sex.linked-1",
    "title": "10  Sex Linked Markers",
    "section": "Run filter.sex.linked",
    "text": "Run filter.sex.linked\nThis function identifies sex-linked and autosomal loci present in a SNP dataset (genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\nThe genlight object must contain in gl@other$ind.metrics a column named “id”, and a column named “sex” in which individuals with known-sex are assigned ‘M’ for male, or ‘F’ for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\n\nXX/XY sex chromosomes\n\n\n\nknitr::kable(head(LBP@other$ind.metrics))  # Check that ind.metrics has the necessary columns\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nsex\npop\nYear.collected\nservice\nplate_location\n\n\n\n\nY2\nY2\nF\nYellingbo\n1997\nDLpos17-2786\n1-A1\n\n\nY16\nY16\nM\nYellingbo\n2001\nDLpos17-2786\n1-A10\n\n\nY17\nY17\nF\nYellingbo\n1997\nDLpos17-2786\n1-A11\n\n\nY18\nY18\nF\nYellingbo\n1999\nDLpos17-2786\n1-A12\n\n\nY3\nY3\nF\nYellingbo\n1997\nDLpos17-2786\n1-A2\n\n\nY4\nY4\nM\nYellingbo\n1997\nDLpos17-2786\n1-A3\n\n\n\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = LBP, system = \"xy\")\n\nDetected 162 females and 211 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nFound 77 sex-linked loci:\n   1 Y-linked loci\n   9 sex-biased loci\n   66 X-linked loci\n   1 XY gametologs.\nAnd 923 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nHow many males and females does the dataset contain?\nHow many sex-linked loci were found?\n\n\nNow check the output:\n\nres$y.linked  # Notice that it says 'y-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1 SNPs , size: 4.7 Mb\n\n    missing data: 164 (=43.62 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1 locus labels\n   @loc.all:  1 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$x.linked  # Notice that it says 'x-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  66 SNPs , size: 4.7 Mb\n\n    missing data: 827 (=3.33 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  66 locus labels\n   @loc.all:  66 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$gametolog\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1 SNPs , size: 4.7 Mb\n\n    missing data: 0 (=0 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1 locus labels\n   @loc.all:  1 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$sex.biased\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  9 SNPs , size: 4.7 Mb\n\n    missing data: 853 (=25.21 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  9 locus labels\n   @loc.all:  9 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$autosomal\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  923 SNPs , size: 5.2 Mb\n\n    missing data: 18826 (=5.42 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  923 locus labels\n   @loc.all:  923 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nknitr::kable(head(res$results.table))  # The output table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nindex\ncount.F.miss\ncount.M.miss\ncount.F.scored\ncount.M.scored\nratio\np.value\np.adjusted\nscoringRate.F\nscoringRate.M\ny.linked\nsex.biased\ncount.F.het\ncount.M.het\ncount.F.hom\ncount.M.hom\nstat\nstat.p.value\nstat.p.adjusted\nheterozygosity.F\nheterozygosity.M\nx.linked\nxy.gametolog\n\n\n\n\n28681424-34-G/T\n1\n0\n1\n162\n210\n1.2953770\n1.0000000\n1\n1.0000000\n0.9952607\nFALSE\nFALSE\n1\n0\n161\n210\n1.303397\n1.0000000\n1.0000000\n0.0061728\n0.0000000\nFALSE\nFALSE\n\n\n28678947-56-C/T\n2\n12\n8\n150\n203\n2.0261283\n0.1638428\n1\n0.9259259\n0.9620853\nFALSE\nFALSE\n9\n7\n141\n196\n1.784196\n0.3044519\n0.9598961\n0.0600000\n0.0344828\nFALSE\nFALSE\n\n\n28680567-32-T/G\n3\n12\n12\n150\n199\n1.3256351\n0.5289429\n1\n0.9259259\n0.9431280\nFALSE\nFALSE\n9\n11\n141\n188\n1.090635\n1.0000000\n1.0000000\n0.0600000\n0.0552764\nFALSE\nFALSE\n\n\n28688313-7-C/G\n4\n0\n0\n162\n211\n1.3015303\n1.0000000\n1\n1.0000000\n1.0000000\nFALSE\nFALSE\n6\n0\n156\n211\n8.076192\n0.0459068\n0.3917911\n0.0370370\n0.0000000\nFALSE\nFALSE\n\n\n28681679-51-C/T\n5\n22\n30\n140\n181\n0.9482168\n0.8814171\n1\n0.8641975\n0.8578199\nFALSE\nFALSE\n1\n1\n139\n180\n1.293900\n1.0000000\n1.0000000\n0.0071429\n0.0055249\nFALSE\nFALSE\n\n\n28681994-14-G/A\n6\n0\n1\n162\n210\n1.2953770\n1.0000000\n1\n1.0000000\n0.9952607\nFALSE\nFALSE\n18\n19\n144\n191\n1.255791\n0.6007790\n1.0000000\n0.1111111\n0.0904762\nFALSE\nFALSE\n\n\n\n\n\nThe output consists of a genlight object for each type of loci, plus a results table."
  },
  {
    "objectID": "session10.html#run-infer.sex-1",
    "href": "session10.html#run-infer.sex-1",
    "title": "10  Sex Linked Markers",
    "section": "Run infer.sex",
    "text": "Run infer.sex\nThis function uses the output of function filter.sex.linked (list of 6 objects) to infer the sex of all individuals in the dataset. It uses 3 types of sex-linked loci (W-/Y-linked, Z-/X-linked, and gametologs), assigns a preliminary genetic sex for each type of sex-linked loci available, and outputs an agreed sex.\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"xy\",\n    seed = 124)\n\nNot enough gametologs (need at least 5). Assigning NA...\n\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\ny.linked.sex\n#called\n#missing\nx.linked.sex\n#Het.x\n#Hom.x\ngametolog.sex\n#Het.g\n#Hom.g\nagreed.sex\n\n\n\n\nY2\nY2\nF\n0\n1\nF\n19\n47\nNA\nNA\nNA\nF\n\n\nY16\nY16\nM\n1\n0\nM\n2\n56\nNA\nNA\nNA\nM\n\n\nY17\nY17\nF\n0\n1\nF\n27\n37\nNA\nNA\nNA\nF\n\n\nY18\nY18\nF\n0\n1\nM\n4\n62\nNA\nNA\nNA\n*F\n\n\nY3\nY3\nM\n1\n0\nM\n3\n63\nNA\nNA\nNA\nM\n\n\nY4\nY4\nM\n1\n0\nM\n1\n63\nNA\nNA\nNA\nM\n\n\n\n\n\nWhat did the function mention about gametologs? How did that impact the results table? How many types of sex-linked loci were used to infer an agreed sex?\n\n\n\n\n\n\nExercise\n\n\n\n\nCan you find individuals for which the agreed sex is uncertain (i.e., has an asterisk “*”)?"
  },
  {
    "objectID": "session10.html#exercise-data-1---your-own-data",
    "href": "session10.html#exercise-data-1---your-own-data",
    "title": "10  Sex Linked Markers",
    "section": "Exercise data 1 - Your own data",
    "text": "Exercise data 1 - Your own data\n\nHINT\nYou can have a look at the exercise data below for inspiration.\n\n\n\n\n\n\n\nExercise - Your own data\n\n\n\n\nNumber of sex-linked markers?\nIndividuals with wrong sexID?\nChanges in PCA before and after removing the SLM?\nDifferences in genetic diversity and fixation indices between autosomal and SLM?"
  },
  {
    "objectID": "session10.html#exercise-data-2---the-eastern-yellow-robin",
    "href": "session10.html#exercise-data-2---the-eastern-yellow-robin",
    "title": "10  Sex Linked Markers",
    "section": "Exercise data 2 - The Eastern Yellow Robin",
    "text": "Exercise data 2 - The Eastern Yellow Robin\nData from Robledo-Ruiz et al. 2023.\n\n\n\nThe Eastern Yellow Robin\n\n\n\nLoad data\n\ndata(\"EYR\")\n\nEYR@n.loc\ntable(EYR@pop)\ntable(EYR@other$ind.metrics$pop)\ntable(EYR@other$ind.metrics$sex, useNA = \"ifany\")\n\n[1] 1000\n\n    Crusoe Muckleford      Timor     Wombat \n       238        421         52         71 \n\n    Crusoe Muckleford      Timor     Wombat \n       238        421         52         71 \n\n      F   M \n  1 352 429 \n\n\n\n\n1. Number of sex-linked markers?\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = EYR, system = \"zw\")\n\nDetected 352 females and 429 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nFound 150 sex-linked loci:\n   16 W-linked loci\n   82 sex-biased loci\n   32 Z-linked loci\n   20 ZW gametologs.\nAnd 850 autosomal loci.\n\n\n\n\n\n\n\n2. Individuals with wrong sexID?\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"zw\",\n    seed = 124)\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\nsum(EYR$other$ind.metrics$sex != sexID$agreed.sex, na.rm = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nw.linked.sex\n#missing\n#called\nz.linked.sex\n#Hom.z\n#Het.z\ngametolog.sex\n#Hom.g\n#Het.g\nagreed.sex\n\n\n\n\n024-96401\n024-96401\nM\n0\n16\nM\n7\n25\nM\n0\n5\nM\n\n\n024-96401b\n024-96401b\nM\n0\n16\nM\n9\n21\nM\n0\n5\nM\n\n\n024-96402\n024-96402\nF\n15\n1\nF\n0\n32\nF\n5\n0\nF\n\n\n024-96403\n024-96403\nM\n1\n15\nM\n11\n21\nM\n0\n5\nM\n\n\n024-96404\n024-96404\nM\n0\n16\nM\n12\n20\nM\n0\n5\nM\n\n\n024-96405\n024-96405\nM\n0\n16\nM\n11\n21\nM\n0\n5\nM\n\n\n\n\n\n[1] 55\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nCan you tell which misidentified sexes are due to uncertain genetic sex (indicated with *)?\nHINT Try using grep(pattern = \"\\\\*\", x = sexID$agreed.sex)\n\n\n\nProcessing SNPs with two filtering regimes\n\nFiltering SNPs only with standard filters (sloppy)\n\n# Filter for read depth\ndartR.base::gl.report.rdepth(EYR)  # This is the initial dataset\n\nStarting :: \n Starting dartR.base \n Starting gl.report.rdepth \n  Processing genlight object with SNP data\n  Reporting Read Depth by Locus\n  No. of loci = 1000 \n  No. of individuals = 782 \n    Minimum      :  2.6 \n    1st quartile :  4.3 \n    Median       :  5.6 \n    Mean         :  5.9649 \n    3r quartile  :  7.325 \n    Maximum      :  13.2 \n    Missing Rate Overall:  0.19 \n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%      13.2        1     0.1      999    99.9\n2       95%       9.9       51     5.1      949    94.9\n3       90%       9.0      105    10.5      895    89.5\n4       85%       8.3      151    15.1      849    84.9\n5       80%       7.8      208    20.8      792    79.2\n6       75%       7.3      258    25.8      742    74.2\n7       70%       6.9      304    30.4      696    69.6\n8       65%       6.5      354    35.4      646    64.6\n9       60%       6.2      404    40.4      596    59.6\n10      55%       5.9      451    45.1      549    54.9\n11      50%       5.6      504    50.4      496    49.6\n12      45%       5.3      563    56.3      437    43.7\n13      40%       5.1      602    60.2      398    39.8\n14      35%       4.8      659    65.9      341    34.1\n15      30%       4.6      702    70.2      298    29.8\n16      25%       4.3      752    75.2      248    24.8\n17      20%       4.0      823    82.3      177    17.7\n18      15%       3.9      852    85.2      148    14.8\n19      10%       3.6      906    90.6       94     9.4\n20       5%       3.3      956    95.6       44     4.4\n21       0%       2.6     1000   100.0        0     0.0\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.rdepth \n\nEYR.sloppy &lt;- dartR.base::gl.filter.rdepth(EYR, lower = 3, upper = 11, verbose = 0)\n\n\n\n# Filter for loci call rate\ndartR.base::gl.report.callrate(EYR.sloppy, method = \"loc\")\n\nStarting :: \n Starting dartR.base \n Starting gl.report.callrate \n  Processing genlight object with SNP data\n  Reporting Call Rate by Locus\n  No. of loci = 958 \n  No. of individuals = 782 \n    Minimum      :  0.20844 \n    1st quartile :  0.7202688 \n    Median       :  0.895141 \n    Mean         :  0.8131871 \n    3r quartile  :  0.950128 \n    Maximum      :  0.988491 \n    Missing Rate Overall:  0.1868 \n\n\n\n\n\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.callrate \n\nEYR.sloppy &lt;- dartR.base::gl.filter.callrate(EYR.sloppy, method = \"loc\",\n    threshold = 0.75, verbose = 0, recalc = TRUE)\n\n# Filter for individual call rate\ndartR.base::gl.report.callrate(EYR.sloppy, method = \"ind\")\n\nStarting :: \n Starting dartR.base \n Starting gl.report.callrate \n  Processing genlight object with SNP data\n\n  Reporting Call Rate by Individual\n  No. of loci = 703 \n  No. of individuals = 782 \n    Minimum      :  0.03556188 \n    1st quartile :  0.9174964 \n    Median       :  0.9416785 \n    Mean         :  0.9108097 \n    3r quartile  :  0.9573257 \n    Maximum      :  0.9829303 \n    Missing Rate Overall:  0.0892 \n\nListing 4 populations and their average CallRates\n  Monitor again after filtering\n  Population CallRate   N\n1     Crusoe   0.9027 238\n2 Muckleford   0.9073 421\n3      Timor   0.9402  52\n4     Wombat   0.9371  71\n\nListing 20 individuals with the lowest CallRates\n  Use this list to see which individuals will be lost on filtering by individual\n  Set ind.to.list parameter to see more individuals\n   Individual   CallRate\n1    M18.29.1 0.03556188\n2    M18.18.1 0.03982930\n3    M18.47.2 0.06970128\n4    C18.16.1 0.07112376\n5   027-34168 0.07681366\n6    C18.15.2 0.08534851\n7    C18.21.2 0.08677098\n8    M18.47.3 0.14224751\n9    M18.35.2 0.17211949\n10   M18.20.3 0.24039829\n11   M20.70.2 0.39687055\n12   C18.28.1 0.39971550\n13   C18.17.2 0.46088193\n14  027-34065 0.50640114\n15   C18.14.1 0.50640114\n16   M20.70.3 0.50782361\n17  M20.110.1 0.52347084\n18   M19.12.1 0.53342817\n19    M19.8.1 0.54907539\n20   M20.64.3 0.56045519\n\n)\n\n\n\n\n\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.callrate \n\nEYR.sloppy &lt;- dartR.base::gl.filter.callrate(EYR.sloppy, method = \"ind\",\n    threshold = 0.65, verbose = 0, recalc = TRUE)\n# Filter for MAC (= 3)\ndartR.base::gl.report.maf(EYR.sloppy)\n\nStarting :: \n Starting dartR.base \n Starting gl.report.maf \n  Processing genlight object with SNP data\nStarting :: \n\n Starting dartR.base \n\n Starting gl.report.maf \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Crusoe \n  No. of loci = 670 \n  No. of individuals = 231 \n    Minimum      :  0.0022 \n    1st quantile :  0.064825 \n    Median       :  0.1582 \n    Mean         :  0.1793525 \n    3r quantile  :  0.267475 \n    Maximum      :  0.4975 \n    Missing Rate Overall:  0.08 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Muckleford \n  No. of loci = 683 \n  No. of individuals = 401 \n    Minimum      :  0.0013 \n    1st quantile :  0.05875 \n    Median       :  0.1404 \n    Mean         :  0.172949 \n    3r quantile  :  0.2617 \n    Maximum      :  0.4985 \n    Missing Rate Overall:  0.07 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Timor \n  No. of loci = 589 \n  No. of individuals = 52 \n    Minimum      :  0.0096 \n    1st quantile :  0.0673 \n    Median       :  0.1667 \n    Mean         :  0.1914129 \n    3r quantile  :  0.2872 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Wombat \n  No. of loci = 627 \n  No. of individuals = 71 \n    Minimum      :  0.007 \n    1st quantile :  0.06385 \n    Median       :  0.1449 \n    Mean         :  0.1746703 \n    3r quantile  :  0.2542 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus OVERALL\n  No. of loci = 703 \n  No. of individuals = 755 \n    Minimum      :  3e-04 \n    1st quantile :  0.0627 \n    Median       :  0.13435 \n    Mean         :  0.1696497 \n    3r quantile  :  0.246025 \n    Maximum      :  0.4991 \n    Missing Rate Overall:  0.07 \n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%    0.4991        1     0.1      699    99.9\n2       95%    0.4343       36     5.1      664    94.9\n3       90%    0.3807       71    10.1      629    89.9\n4       85%    0.3331      105    15.0      595    85.0\n5       80%    0.2858      141    20.1      559    79.9\n6       75%    0.2460      176    25.1      524    74.9\n7       70%    0.2233      210    30.0      490    70.0\n8       65%    0.2003      246    35.1      454    64.9\n9       60%    0.1797      280    40.0      420    60.0\n10      55%    0.1562      315    45.0      385    55.0\n11      50%    0.1341      352    50.3      348    49.7\n12      45%    0.1214      386    55.1      314    44.9\n13      40%    0.1032      421    60.1      279    39.9\n14      35%    0.0904      455    65.0      245    35.0\n15      30%    0.0742      490    70.0      210    30.0\n16      25%    0.0627      526    75.1      174    24.9\n17      20%    0.0476      561    80.1      139    19.9\n18      15%    0.0359      595    85.0      105    15.0\n19      10%    0.0224      631    90.1       69     9.9\n20       5%    0.0059      666    95.1       34     4.9\n21       0%    0.0003      700   100.0        0     0.0\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.maf \n\nEYR.sloppy &lt;- dartR.base::gl.filter.maf(EYR.sloppy, threshold = 3, verbose = 0,\n    recalc = TRUE)\n\nStarting gl.select.colors \n  Warning: Number of required colors not specified, set to 9\n  Library: RColorBrewer\n  Palette: brewer.pal\n  Showing and returning 2 of 9 colors for library RColorBrewer : palette Blues \n\n\n\n\n\nCompleted: gl.select.colors \n\n\n\n\nFiltering SNPs with filter.sex.linked and standard filters (correct)\n\n# Filter for sex-linked loci\ncorrect &lt;- dartR.sexlinked::filter.sex.linked(EYR, system = \"zw\")  # This is the initial dataset\n\n\n\n\n\n\n\n\n\n\n\n\n# We will use correct$autosomal for the next filters\n\n# Filter for read depth\ndartR.base::gl.report.rdepth(correct$autosomal)  # This is the filtered dataset\n\nStarting :: \n Starting dartR.base \n Starting gl.report.rdepth \n  Processing genlight object with SNP data\n  Reporting Read Depth by Locus\n  No. of loci = 850 \n  No. of individuals = 782 \n    Minimum      :  2.6 \n    1st quartile :  4.3 \n    Median       :  5.6 \n    Mean         :  6.008941 \n    3r quartile  :  7.4 \n    Maximum      :  13.2 \n    Missing Rate Overall:  0.18 \n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%      13.2        1     0.1      849    99.9\n2       95%       9.9       45     5.3      805    94.7\n3       90%       9.1       88    10.4      762    89.6\n4       85%       8.4      129    15.2      721    84.8\n5       80%       7.9      173    20.4      677    79.6\n6       75%       7.4      220    25.9      630    74.1\n7       70%       6.9      264    31.1      586    68.9\n8       65%       6.5      305    35.9      545    64.1\n9       60%       6.2      350    41.2      500    58.8\n10      55%       5.9      391    46.0      459    54.0\n11      50%       5.6      435    51.2      415    48.8\n12      45%       5.4      472    55.5      378    44.5\n13      40%       5.1      519    61.1      331    38.9\n14      35%       4.9      555    65.3      295    34.7\n15      30%       4.6      603    70.9      247    29.1\n16      25%       4.3      645    75.9      205    24.1\n17      20%       4.0      705    82.9      145    17.1\n18      15%       3.9      730    85.9      120    14.1\n19      10%       3.6      774    91.1       76     8.9\n20       5%       3.3      812    95.5       38     4.5\n21       0%       2.6      850   100.0        0     0.0\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.rdepth \n\nEYR.correct &lt;- dartR.base::gl.filter.rdepth(correct$autosomal, lower = 3,\n    upper = 11, verbose = 0)\n\n\n\n# Filter for loci call rate\ndartR.base::gl.report.callrate(EYR.correct, method = \"loc\")\n\nStarting :: \n Starting dartR.base \n Starting gl.report.callrate \n  Processing genlight object with SNP data\n  Reporting Call Rate by Locus\n  No. of loci = 811 \n  No. of individuals = 782 \n    Minimum      :  0.20844 \n    1st quartile :  0.7436065 \n    Median       :  0.900256 \n    Mean         :  0.8192658 \n    3r quartile  :  0.951407 \n    Maximum      :  0.988491 \n    Missing Rate Overall:  0.1807 \n\n\n\n\n\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.callrate \n\nEYR.correct &lt;- dartR.base::gl.filter.callrate(EYR.correct, method = \"loc\",\n    threshold = 0.75, verbose = 0, recalc = TRUE)\n\n# Filter for individual call rate\ndartR.base::gl.report.callrate(EYR.correct, method = \"ind\")\n\nStarting :: \n Starting dartR.base \n Starting gl.report.callrate \n  Processing genlight object with SNP data\n\n  Reporting Call Rate by Individual\n  No. of loci = 605 \n  No. of individuals = 782 \n    Minimum      :  0.03801653 \n    1st quartile :  0.9173554 \n    Median       :  0.9438017 \n    Mean         :  0.9120479 \n    3r quartile  :  0.9586777 \n    Maximum      :  0.9818182 \n    Missing Rate Overall:  0.088 \n\nListing 4 populations and their average CallRates\n  Monitor again after filtering\n  Population CallRate   N\n1     Crusoe   0.9037 238\n2 Muckleford   0.9090 421\n3      Timor   0.9418  52\n4     Wombat   0.9365  71\n\nListing 20 individuals with the lowest CallRates\n  Use this list to see which individuals will be lost on filtering by individual\n  Set ind.to.list parameter to see more individuals\n   Individual   CallRate\n1    M18.29.1 0.03801653\n2    M18.18.1 0.04462810\n3    M18.47.2 0.06776860\n4    C18.16.1 0.07438017\n5   027-34168 0.08760331\n6    C18.15.2 0.08760331\n7    C18.21.2 0.08760331\n8    M18.47.3 0.13719008\n9    M18.35.2 0.18016529\n10   M18.20.3 0.24132231\n11   C18.28.1 0.41487603\n12   M20.70.2 0.42644628\n13   C18.17.2 0.44628099\n14  027-34065 0.49586777\n15   C18.14.1 0.49752066\n16  M20.110.1 0.53057851\n17   M20.70.3 0.53553719\n18   M19.12.1 0.54380165\n19    M19.8.1 0.56694215\n20   M19.33.2 0.57851240\n\n)\n\n\n\n\n\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.callrate \n\nEYR.correct &lt;- dartR.base::gl.filter.callrate(EYR.correct, method = \"ind\",\n    threshold = 0.65, verbose = 0, recalc = TRUE)\n# Filter for MAC (= 3)\ndartR.base::gl.report.maf(EYR.correct)\n\nStarting :: \n Starting dartR.base \n Starting gl.report.maf \n  Processing genlight object with SNP data\nStarting :: \n\n Starting dartR.base \n\n Starting gl.report.maf \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Crusoe \n  No. of loci = 573 \n  No. of individuals = 231 \n    Minimum      :  0.0022 \n    1st quantile :  0.06 \n    Median       :  0.1488 \n    Mean         :  0.1741178 \n    3r quantile  :  0.2646 \n    Maximum      :  0.4975 \n    Missing Rate Overall:  0.08 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Muckleford \n  No. of loci = 585 \n  No. of individuals = 401 \n    Minimum      :  0.0013 \n    1st quantile :  0.055 \n    Median       :  0.129 \n    Mean         :  0.163993 \n    3r quantile  :  0.2474 \n    Maximum      :  0.4985 \n    Missing Rate Overall:  0.07 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Timor \n  No. of loci = 504 \n  No. of individuals = 52 \n    Minimum      :  0.0096 \n    1st quantile :  0.068275 \n    Median       :  0.1635 \n    Mean         :  0.1898613 \n    3r quantile  :  0.286075 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Wombat \n  No. of loci = 536 \n  No. of individuals = 71 \n    Minimum      :  0.007 \n    1st quantile :  0.062475 \n    Median       :  0.13805 \n    Mean         :  0.1706063 \n    3r quantile  :  0.2509 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus OVERALL\n  No. of loci = 605 \n  No. of individuals = 755 \n    Minimum      :  3e-04 \n    1st quantile :  0.058025 \n    Median       :  0.1306 \n    Mean         :  0.1628656 \n    3r quantile  :  0.23785 \n    Maximum      :  0.4991 \n    Missing Rate Overall:  0.07 \n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%    0.4991        1     0.2      601    99.8\n2       95%    0.4367       31     5.1      571    94.9\n3       90%    0.3771       61    10.1      541    89.9\n4       85%    0.3250       91    15.1      511    84.9\n5       80%    0.2747      121    20.1      481    79.9\n6       75%    0.2387      151    25.1      451    74.9\n7       70%    0.2132      181    30.1      421    69.9\n8       65%    0.1916      211    35.0      391    65.0\n9       60%    0.1720      241    40.0      361    60.0\n10      55%    0.1486      271    45.0      331    55.0\n11      50%    0.1306      302    50.2      300    49.8\n12      45%    0.1118      332    55.1      270    44.9\n13      40%    0.0975      362    60.1      240    39.9\n14      35%    0.0808      392    65.1      210    34.9\n15      30%    0.0700      422    70.1      180    29.9\n16      25%    0.0578      452    75.1      150    24.9\n17      20%    0.0445      482    80.1      120    19.9\n18      15%    0.0300      512    85.0       90    15.0\n19      10%    0.0174      542    90.0       60    10.0\n20       5%    0.0046      572    95.0       30     5.0\n21       0%    0.0003      602   100.0        0     0.0\nCompleted: :: \n Completed: dartR.base \n Completed: gl.report.maf \n\nEYR.correct &lt;- dartR.base::gl.filter.maf(EYR.correct, threshold = 3, verbose = 0,\n    recalc = TRUE)\n\nStarting gl.select.colors \n  Warning: Number of required colors not specified, set to 9\n  Library: RColorBrewer\n  Palette: brewer.pal\n  Showing and returning 2 of 9 colors for library RColorBrewer : palette Blues \n\n\n\n\n\nCompleted: gl.select.colors \n\n\n\n\n\n\n3. Changes in PCA before and after removing the SLM?\n\nPCA on sloppy dataset (only standard filters)\n\nPCA.sloppy &lt;- dartR.base::gl.pcoa(EYR.sloppy, verbose = 0)\ndartR.base::gl.pcoa.plot(PCA.sloppy, EYR.sloppy, xaxis = 1, yaxis = 2)\ndartR.base::gl.pcoa.plot(PCA.sloppy, EYR.sloppy, xaxis = 2, yaxis = 3)\n\nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \nStarting :: \n Starting dartR.base \n Starting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\nPackage directlabels  needed for this function to work. Please install it.\n[1] -1\nStarting :: \n Starting dartR.base \n Starting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\nPackage directlabels  needed for this function to work. Please install it.\n[1] -1\n\n\n\n\nPCA on correct dataset (filter.sex.linked and standard filters)\n\nPCA.correct &lt;- dartR.base::gl.pcoa(EYR.correct, verbose = 0)\ndartR.base::gl.pcoa.plot(PCA.correct, EYR.correct, xaxis = 1, yaxis = 2)\ndartR.base::gl.pcoa.plot(PCA.correct, EYR.correct, xaxis = 2, yaxis = 3)\n\nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \nStarting :: \n Starting dartR.base \n Starting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\nPackage directlabels  needed for this function to work. Please install it.\n[1] -1\nStarting :: \n Starting dartR.base \n Starting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\nPackage directlabels  needed for this function to work. Please install it.\n[1] -1\n\n\n\n\n\n4. Differences in genetic diversity and fixation indices between autosomal and SLM?\n\n# Basic stats\nbasic.sloppy &lt;- dartR.base::utils.basic.stats(EYR.sloppy)\nbasic.correct &lt;- dartR.base::utils.basic.stats(EYR.correct)\nbasic.sloppy$overall\n\n     Ho      Hs      Ht     Dst     Htp    Dstp     Fst    Fstp     Fis    Dest \n 0.1603  0.2376  0.2464  0.0087  0.2487  0.0148  0.0355  0.0596  0.3256  0.0259 \nGst_max   Gst_H \n 0.7141  0.0834 \n\nbasic.correct$overall\n\n     Ho      Hs      Ht     Dst     Htp    Dstp     Fst    Fstp     Fis    Dest \n 0.1579  0.2302  0.2375  0.0073  0.2398  0.0128  0.0307  0.0532  0.3139  0.0221 \nGst_max   Gst_H \n 0.7229  0.0737 \n\n# Genetic diversity per pop\ndivers.sloppy &lt;- dartR.base::gl.report.diversity(EYR.sloppy, pbar = FALSE,\n    table = FALSE, verbose = 0)\n\n  Processing genlight object with SNP data\n\n\n\n\ndivers.correct &lt;- dartR.base::gl.report.diversity(EYR.correct, pbar = FALSE,\n    table = FALSE, verbose = 0)\n\n  Processing genlight object with SNP data\n\n\n\n\ndivers.sloppy$one_H_alpha\n\n    Crusoe Muckleford      Timor     Wombat \n 0.3884366  0.3844244  0.3519361  0.3591638 \n\ndivers.correct$one_H_alpha\n\n    Crusoe Muckleford      Timor     Wombat \n 0.3766483  0.3689045  0.3468530  0.3503540 \n\ndivers.sloppy$one_H_beta\n\n                Crusoe Muckleford      Timor     Wombat\nCrusoe              NA 0.02660219 0.09367676 0.06237102\nMuckleford 0.006274769         NA 0.07326488 0.06577359\nTimor      0.022518949 0.02452504         NA 0.08763552\nWombat     0.018905085 0.02091118 0.03715536         NA\n\ndivers.correct$one_H_beta\n\n                Crusoe Muckleford      Timor     Wombat\nCrusoe              NA 0.02545762 0.08568969 0.05988791\nMuckleford 0.005778848         NA 0.06967786 0.06243346\nTimor      0.016804630 0.02067653         NA 0.08306746\nWombat     0.015054123 0.01892602 0.02995180         NA\n\n# Fixation indices\ndartR.base::gl.fst.pop(EYR.sloppy, verbose = 0)\n\n               Crusoe Muckleford      Timor Wombat\nCrusoe             NA         NA         NA     NA\nMuckleford 0.03160198         NA         NA     NA\nTimor      0.04023766 0.05408752         NA     NA\nWombat     0.05466955 0.02407235 0.08452847     NA\n\ndartR.base::gl.fst.pop(EYR.correct, verbose = 0)\n\n               Crusoe Muckleford      Timor Wombat\nCrusoe             NA         NA         NA     NA\nMuckleford 0.02777612         NA         NA     NA\nTimor      0.04008148 0.04786375         NA     NA\nWombat     0.04413257 0.02208816 0.07111737     NA\n\ndartR.base::gl.report.fstat(EYR.sloppy, verbose = 0)\n\n   Your plot was not shown in full because your 'Plots' pane\n    is too small. Increase the size of the 'Plots' pane and run the\n    function again. Alternatively, use the parameter 'plot.file' to\n    save the plot to a file.\n\n\n$Stat_matrices\n$Stat_matrices$Fst\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0148 0.0171 0.0255\nMuckleford 0.0148         NA 0.0249 0.0096\nTimor      0.0171     0.0249     NA 0.0387\nWombat     0.0255     0.0096 0.0387     NA\n\n$Stat_matrices$Fstp\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0356 0.0545 0.0669\nMuckleford 0.0356         NA 0.0681 0.0337\nTimor      0.0545     0.0681     NA 0.1046\nWombat     0.0669     0.0337 0.1046     NA\n\n$Stat_matrices$Dest\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0236 0.0351 0.0434\nMuckleford 0.0236         NA 0.0437 0.0213\nTimor      0.0351     0.0437     NA 0.0657\nWombat     0.0434     0.0213 0.0657     NA\n\n$Stat_matrices$Gst_H\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0566 0.0850 0.1047\nMuckleford 0.0566         NA 0.1059 0.0525\nTimor      0.0850     0.1059     NA 0.1603\nWombat     0.1047     0.0525 0.1603     NA\n\n\n[[2]]\n      Stat_tables.Crusoe_vs_Muckleford Stat_tables.Crusoe_vs_Timor\nFst                             0.0148                      0.0171\nFstp                            0.0356                      0.0545\nDest                            0.0236                      0.0351\nGst_H                           0.0566                      0.0850\n      Stat_tables.Crusoe_vs_Wombat Stat_tables.Muckleford_vs_Timor\nFst                         0.0255                          0.0249\nFstp                        0.0669                          0.0681\nDest                        0.0434                          0.0437\nGst_H                       0.1047                          0.1059\n      Stat_tables.Muckleford_vs_Wombat Stat_tables.Timor_vs_Wombat\nFst                             0.0096                      0.0387\nFstp                            0.0337                      0.1046\nDest                            0.0213                      0.0657\nGst_H                           0.0525                      0.1603\n\ndartR.base::gl.report.fstat(EYR.correct, verbose = 0)\n\n   Your plot was not shown in full because your 'Plots' pane\n    is too small. Increase the size of the 'Plots' pane and run the\n    function again. Alternatively, use the parameter 'plot.file' to\n    save the plot to a file.\n\n\n$Stat_matrices\n$Stat_matrices$Fst\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0128 0.0168 0.0199\nMuckleford 0.0128         NA 0.0212 0.0085\nTimor      0.0168     0.0212     NA 0.0313\nWombat     0.0199     0.0085 0.0313     NA\n\n$Stat_matrices$Fstp\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0317 0.0540 0.0556\nMuckleford 0.0317         NA 0.0608 0.0315\nTimor      0.0540     0.0608     NA 0.0903\nWombat     0.0556     0.0315 0.0903     NA\n\n$Stat_matrices$Dest\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0199 0.0337 0.0344\nMuckleford 0.0199         NA 0.0373 0.0189\nTimor      0.0337     0.0373     NA 0.0547\nWombat     0.0344     0.0189 0.0547     NA\n\n$Stat_matrices$Gst_H\n           Crusoe Muckleford  Timor Wombat\nCrusoe         NA     0.0492 0.0832 0.0856\nMuckleford 0.0492         NA 0.0930 0.0480\nTimor      0.0832     0.0930     NA 0.1368\nWombat     0.0856     0.0480 0.1368     NA\n\n\n[[2]]\n      Stat_tables.Crusoe_vs_Muckleford Stat_tables.Crusoe_vs_Timor\nFst                             0.0128                      0.0168\nFstp                            0.0317                      0.0540\nDest                            0.0199                      0.0337\nGst_H                           0.0492                      0.0832\n      Stat_tables.Crusoe_vs_Wombat Stat_tables.Muckleford_vs_Timor\nFst                         0.0199                          0.0212\nFstp                        0.0556                          0.0608\nDest                        0.0344                          0.0373\nGst_H                       0.0856                          0.0930\n      Stat_tables.Muckleford_vs_Wombat Stat_tables.Timor_vs_Wombat\nFst                             0.0085                      0.0313\nFstp                            0.0315                      0.0903\nDest                            0.0189                      0.0547\nGst_H                           0.0480                      0.1368"
  },
  {
    "objectID": "session10.html#exercise-data-3---bull-shark",
    "href": "session10.html#exercise-data-3---bull-shark",
    "title": "10  Sex Linked Markers",
    "section": "Exercise data 3 - Bull shark",
    "text": "Exercise data 3 - Bull shark\nData from Devloo-Delva et al. 2023.\n\n\n\nThe Bull Shark\n\n\n\nLoad data\n\nprint(load(\"data/Bull_shark_DArTseq_genlight_for_sex-linked_markers.Rdata\"))\n\n[1] \"data.gl\"\n\ndata.gl@n.loc\n\n[1] 93202\n\ntable(data.gl@pop)\n\n\nE-ATL  E-IO  Fiji Japan  N-IO W-ATL  W-IO W-PAC \n    2    36     8    14    20    36    40    26 \n\ntable(data.gl@other$ind.metrics$pop)\n\n\nE-ATL  E-IO  Fiji Japan  N-IO W-ATL  W-IO W-PAC \n    2    36     8    14    20    36    40    26 \n\ntable(data.gl@other$ind.metrics$sex, useNA = \"ifany\")\n\n\n   F    M &lt;NA&gt; \n  85   64   33 \n\n\n\n\n1. Number of sex-linked markers?\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = data.gl, system = \"xy\", plots = TRUE,\n    ncores = 1)\n\nDetected 85 females and 64 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 93202.\nFound 9 sex-linked loci:\n   2 Y-linked loci\n   2 sex-biased loci\n   4 X-linked loci\n   1 XY gametologs.\nAnd 93193 autosomal loci.\n\n\n\n\n\n\n\n2. Individuals with wrong sexID?\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"xy\",\n    seed = 124)\n\nNot enough gametologs (need at least 5). Assigning NA...\n\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\nagreed.sex &lt;- sub(pattern = \"\\\\*\", replacement = \"\", x = sexID$agreed.sex)  # remove asterisk\nsum(data.gl$other$ind.metrics$sex != agreed.sex, na.rm = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\ny.linked.sex\n#called\n#missing\nx.linked.sex\n#Het.x\n#Hom.x\ngametolog.sex\n#Het.g\n#Hom.g\nagreed.sex\n\n\n\n\nCL-FIJ002-F\nCL-FIJ002-F\nF\n0\n2\nF\n4\n0\nNA\nNA\nNA\nF\n\n\nCL-FIJ003-M\nCL-FIJ003-M\nM\n2\n0\nM\n0\n4\nNA\nNA\nNA\nM\n\n\nCL-FIJ008-F\nCL-FIJ008-F\nF\n0\n2\nF\n2\n2\nNA\nNA\nNA\nF\n\n\nCL-FIJ010-F\nCL-FIJ010-F\nF\n0\n2\nF\n3\n1\nNA\nNA\nNA\nF\n\n\nCL-FIJ015-F\nCL-FIJ015-F\nF\n0\n2\nF\n4\n0\nNA\nNA\nNA\nF\n\n\nCL-FIJ018-F\nCL-FIJ018-F\nF\n0\n2\nF\n3\n1\nNA\nNA\nNA\nF\n\n\n\n\n\n[1] 8"
  },
  {
    "objectID": "session10.html#exercise-data-4---blue-shark",
    "href": "session10.html#exercise-data-4---blue-shark",
    "title": "10  Sex Linked Markers",
    "section": "Exercise data 4 - Blue shark",
    "text": "Exercise data 4 - Blue shark\nData from Nikolic et al. 2023.\n\n\n\nThe Blue Shark\n\n\n\nLoad data\n\nprint(load(\"data/Blue_shark_DArTseq_genlight_for_sex-linked_markers.Rdata\"))\n\n[1] \"data.gl\"\n\ndata.gl@n.loc\n\n[1] 172384\n\ntable(data.gl@pop)\n\n\n   EIO   MED1   MED2   NATL  NEATL    NIO   NPAC   SAF1   SAF2 SWPAC1 SWPAC2 \n     8     34     20     49     26     27      4     21     89     30     16 \nSWPAC3    WIO \n    11     29 \n\ntable(data.gl@other$ind.metrics$pop)\n\n\n   EIO   MED1   MED2   NATL  NEATL    NIO   NPAC   SAF1   SAF2 SWPAC1 SWPAC2 \n     8     34     20     49     26     27      4     21     89     30     16 \nSWPAC3    WIO \n    11     29 \n\ntable(data.gl@other$ind.metrics$sex, useNA = \"ifany\")\n\n\n   F    M &lt;NA&gt; \n 104  111  149 \n\n\n\n\n1. Number of sex-linked markers?\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = data.gl, system = \"xy\", plots = TRUE,\n    ncores = 1)\n\nDetected 104 females and 111 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 172384.\nFound 26 sex-linked loci:\n   2 Y-linked loci\n   2 sex-biased loci\n   22 X-linked loci\n   0 XY gametologs.\nAnd 172358 autosomal loci.\n\n\n\n\n\n\n\n2. Individuals with wrong sexID?\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"xy\",\n    seed = 124)\n\nNot enough gametologs (need at least 5). Assigning NA...\n\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\nagreed.sex &lt;- sub(pattern = \"\\\\*\", replacement = \"\", x = sexID$agreed.sex)  # remove asterisk\nsum(data.gl$other$ind.metrics$sex != agreed.sex, na.rm = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\ny.linked.sex\n#called\n#missing\nx.linked.sex\n#Het.x\n#Hom.x\ngametolog.sex\n#Het.g\n#Hom.g\nagreed.sex\n\n\n\n\n60088\n60088\nM\n2\n0\nM\n0\n22\nNA\nNA\nNA\nM\n\n\n60160\n60160\nM\n2\n0\nM\n0\n21\nNA\nNA\nNA\nM\n\n\n60168\n60168\nM\n2\n0\nM\n0\n22\nNA\nNA\nNA\nM\n\n\n60176\n60176\nM\n2\n0\nM\n0\n21\nNA\nNA\nNA\nM\n\n\n60096\n60096\nM\n2\n0\nM\n0\n22\nNA\nNA\nNA\nM\n\n\n60104\n60104\nM\n2\n0\nM\n1\n19\nNA\nNA\nNA\nM\n\n\n\n\n\n[1] 22"
  },
  {
    "objectID": "session11.html#required-packages",
    "href": "session11.html#required-packages",
    "title": "11  From Genes to Kin: Dissecting Relatedness & Kinship",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session11.html#session-content",
    "href": "session11.html#session-content",
    "title": "11  From Genes to Kin: Dissecting Relatedness & Kinship",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session11.html#exercise",
    "href": "session11.html#exercise",
    "title": "11  From Genes to Kin: Dissecting Relatedness & Kinship",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session11.html#further-study",
    "href": "session11.html#further-study",
    "title": "11  From Genes to Kin: Dissecting Relatedness & Kinship",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session12.html#required-packages",
    "href": "session12.html#required-packages",
    "title": "12  Genetic Structure",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session12.html#session-content",
    "href": "session12.html#session-content",
    "title": "12  Genetic Structure",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session12.html#exercise",
    "href": "session12.html#exercise",
    "title": "12  Genetic Structure",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session12.html#further-study",
    "href": "session12.html#further-study",
    "title": "12  Genetic Structure",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "session13.html#required-packages",
    "href": "session13.html#required-packages",
    "title": "13  Combining Genomic Resources",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\n\nmake sure you have the packages installed, see Install dartRverse"
  },
  {
    "objectID": "session13.html#session-content",
    "href": "session13.html#session-content",
    "title": "13  Combining Genomic Resources",
    "section": "Session Content",
    "text": "Session Content\nStill to come…"
  },
  {
    "objectID": "session13.html#exercise",
    "href": "session13.html#exercise",
    "title": "13  Combining Genomic Resources",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n Still to come…"
  },
  {
    "objectID": "session13.html#further-study",
    "href": "session13.html#further-study",
    "title": "13  Combining Genomic Resources",
    "section": "Further Study",
    "text": "Further Study\nstill to come…"
  },
  {
    "objectID": "break.html",
    "href": "break.html",
    "title": "__________",
    "section": "",
    "text": "Everything beyond this point is for added learning, we hope you have fun exploring all the amazing things the dartRverse has to offer."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Gruber, Bernd, Peter J. Unmack, Oliver F. Berry, and Arthur Georges.\n2018. “DARTR : An R Package\nto Facilitate Analysis of SNP Data Generated from Reduced\nRepresentation Genome Sequencing.” Molecular Ecology\nResources 18 (3): 691–99. https://doi.org/10.1111/1755-0998.12745.\n\n\nMijangos, Jose Luis, Bernd Gruber, Oliver Berry, Carlo Pacioni, and\nArthur Georges. 2022. “dartR V2:\nAn Accessible Genetic Analysis Platform for Conservation,\nEcology and Agriculture.” Methods in Ecology and\nEvolution 13 (10): 2150–58. https://doi.org/10.1111/2041-210X.13918."
  },
  {
    "objectID": "useful.html#detailed-program",
    "href": "useful.html#detailed-program",
    "title": "More info",
    "section": "Detailed program",
    "text": "Detailed program\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "tutorials.html#dartr-rstudio-refresher",
    "href": "tutorials.html#dartr-rstudio-refresher",
    "title": "dartR Tutorials",
    "section": "dartR RStudio Refresher",
    "text": "dartR RStudio Refresher\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "tutorials.html#dartr-installation",
    "href": "tutorials.html#dartr-installation",
    "title": "dartR Tutorials",
    "section": "dartR Installation",
    "text": "dartR Installation\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "tutorials.html#data-structure-and-input",
    "href": "tutorials.html#data-structure-and-input",
    "title": "dartR Tutorials",
    "section": "Data Structure and Input",
    "text": "Data Structure and Input\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "tutorials.html#data-manipulation",
    "href": "tutorials.html#data-manipulation",
    "title": "dartR Tutorials",
    "section": "Data Manipulation",
    "text": "Data Manipulation\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "tutorials.html#dartr-basic-filtering",
    "href": "tutorials.html#dartr-basic-filtering",
    "title": "dartR Tutorials",
    "section": "dartR Basic Filtering",
    "text": "dartR Basic Filtering\nUnable to display PDF file. Download instead."
  },
  {
    "objectID": "session01.html#how-many",
    "href": "session01.html#how-many",
    "title": "1  Intro to dartR",
    "section": "How many?",
    "text": "How many?\nType the correct number into the blank boxes below:\n\nnumber of SNPs \nnumber of individuals \nnumber of populations \n\nboxes will go green if you have the answer correct"
  },
  {
    "objectID": "session10.html#required-packages",
    "href": "session10.html#required-packages",
    "title": "10  Sex Linked Markers",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dartR.base)\nlibrary(dartR.sexlinked)"
  },
  {
    "objectID": "session10.html#dataset-1---zwzz---the-yellow-tufted-honeyeater",
    "href": "session10.html#dataset-1---zwzz---the-yellow-tufted-honeyeater",
    "title": "10  Sex Linked Markers",
    "section": "Dataset 1 - ZW//ZZ - The Yellow Tufted Honeyeater",
    "text": "Dataset 1 - ZW//ZZ - The Yellow Tufted Honeyeater\n\n\n\nThe Yellow Tufted Honeyeater\n\n\n\nLoad data\n\ndata(\"YTH\")\nYTH  # Explore the dataset\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  994 SNPs , size: 49.9 Mb\n\n    missing data: 139174 (=22.99 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  994 locus labels\n   @loc.all:  994 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nYTH@n.loc  # Number of SNPs\n\n[1] 994\n\nlength(YTH@ind.names)  # Number of individuals\n\n[1] 609\n\n\n\n\nRun filter.sex.linked\nThis function identifies sex-linked and autosomal loci present in a SNP dataset (i.e., genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\nThe genlight object must contain in gl@other$ind.metrics a column named “id”, and a column named “sex” in which individuals with known-sex are assigned ‘M’ for male, or ‘F’ for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\n\nZW/ZZ sex chromosomes\n\n\n\nNOTE\nSet ncores to more than 1 (default) if you have more than 50,000 SNPs, since it could actually slow down the analysis with smaller datasets.\n\n\nknitr::kable(head(YTH@other$ind.metrics))  # Check that ind.metrics has the necessary columns\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\npop\nsex\nsex_original\nservice\nplate_location\n\n\n\n\nANWC46839\nANWC46839\nMelanops\nF\nF\nDLich17-2918\n1-A1\n\n\nW49\nW49\nCassidix\nF\nF\nDLich17-2918\n1-A10\n\n\nW90\nW90\nCassidix\nF\nF\nDLich17-2918\n1-A12\n\n\nC25\nC25\nCassidix\nM\nM\nDLich17-2918\n1-A2\n\n\nC8\nC8\nCassidix\nM\nM\nDLich17-2918\n1-A3\n\n\nW70\nW70\nCassidix\nF\nF\nDLich17-2918\n1-A4\n\n\n\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = YTH, system = \"zw\")\n\nDetected 276 females and 333 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 994.\nFound 506 sex-linked loci:\n   52 W-linked loci\n   273 sex-biased loci\n   165 Z-linked loci\n   16 ZW gametologs.\nAnd 488 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nHow many males and females does the dataset contain?\nHow many sex-linked loci were found?\n\n\nNow check the output:\n\nres$w.linked  # Notice that it says 'w-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  52 SNPs , size: 48.9 Mb\n\n    missing data: 17304 (=54.64 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  52 locus labels\n   @loc.all:  52 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$z.linked  # Notice that it says 'z-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  165 SNPs , size: 48.9 Mb\n\n    missing data: 2990 (=2.98 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  165 locus labels\n   @loc.all:  165 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$gametolog\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  16 SNPs , size: 48.8 Mb\n\n    missing data: 580 (=5.95 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  16 locus labels\n   @loc.all:  16 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$sex.biased\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  273 SNPs , size: 49.2 Mb\n\n    missing data: 46048 (=27.7 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  273 locus labels\n   @loc.all:  273 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nres$autosomal\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 609 genotypes,  488 SNPs , size: 49.4 Mb\n\n    missing data: 72252 (=24.31 %) scored as NA\n\n ** Genetic data\n   @gen: list of 609 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  609 individual labels\n   @loc.names:  488 locus labels\n   @loc.all:  488 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 12-516)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, sex_original, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Lichenostomus_HeHo_v1, ChromPos_Lichenostomus_HeHo_v1, AlnCnt_Lichenostomus_HeHo_v1, AlnEvalue_Lichenostomus_HeHo_v1, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nknitr::kable(head(res$results.table))  # The output table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nindex\ncount.F.miss\ncount.M.miss\ncount.F.scored\ncount.M.scored\nratio\np.value\np.adjusted\nscoringRate.F\nscoringRate.M\nw.linked\nsex.biased\ncount.F.het\ncount.M.het\ncount.F.hom\ncount.M.hom\nstat\nstat.p.value\nstat.p.adjusted\nheterozygosity.F\nheterozygosity.M\nz.linked\nzw.gametolog\n\n\n\n\n27382025-26-T/C\n1\n61\n25\n215\n308\n3.4882302\n0.0000003\n0.0000016\n0.7789855\n0.9249249\nFALSE\nTRUE\n0\n73\n215\n235\nNA\nNA\nNA\n0.0000000\n0.2370130\nFALSE\nFALSE\n\n\n27338005-34-A/G\n2\n12\n13\n264\n320\n1.1186728\n0.8390268\n1.0000000\n0.9565217\n0.9609610\nFALSE\nFALSE\n0\n144\n264\n176\n0.0046581\n0.0000000\n0.0000000\n0.0000000\n0.4500000\nTRUE\nFALSE\n\n\n27331627-16-T/G\n3\n108\n159\n168\n174\n0.7039235\n0.0334301\n0.0860868\n0.6086957\n0.5225225\nFALSE\nFALSE\n0\n2\n168\n172\n0.5128690\n1.0000000\n1.0000000\n0.0000000\n0.0114943\nFALSE\nFALSE\n\n\n53948461-35-G/A\n4\n46\n64\n230\n269\n0.8408645\n0.4593502\n0.7791707\n0.8333333\n0.8078078\nFALSE\nFALSE\n29\n27\n201\n242\n1.2924846\n0.3950852\n0.9051780\n0.1260870\n0.1003717\nFALSE\nFALSE\n\n\n27360874-8-A/G\n5\n41\n63\n235\n270\n0.7480768\n0.1956613\n0.4120495\n0.8514493\n0.8108108\nFALSE\nFALSE\n25\n38\n210\n232\n0.7272744\n0.2807852\n0.7009152\n0.1063830\n0.1407407\nFALSE\nFALSE\n\n\n27377678-32-C/A\n6\n30\n33\n246\n300\n1.1084581\n0.7894511\n1.0000000\n0.8913043\n0.9009009\nFALSE\nFALSE\n3\n6\n243\n294\n0.6054740\n0.5234966\n1.0000000\n0.0121951\n0.0200000\nFALSE\nFALSE\n\n\n\n\n\nThe output consists of a genlight object for each type of loci, plus a results table.\n\n\nRun infer.sex\nThis function uses the complete output of function filter.sex.linked (list of 6 objects) to infer the sex of all individuals in the dataset. Specifically, the function uses 3 types of sex-linked loci (W-/Y-linked, Z-/X-linked, and gametologs), assigns a preliminary genetic sex for each type of sex-linked loci available, and outputs an agreed sex.\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"zw\",\n    seed = 124)\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nw.linked.sex\n#missing\n#called\nz.linked.sex\n#Hom.z\n#Het.z\ngametolog.sex\n#Hom.g\n#Het.g\nagreed.sex\n\n\n\n\nANWC46839\nANWC46839\nF\n51\n1\nF\n1\n141\nF\n5\n0\nF\n\n\nW49\nW49\nF\n52\n0\nF\n2\n156\nF\n5\n0\nF\n\n\nW90\nW90\nF\n48\n4\nF\n0\n162\nF\n5\n0\nF\n\n\nC25\nC25\nM\n0\n52\nM\n52\n113\nM\n0\n5\nM\n\n\nC8\nC8\nM\n0\n52\nM\n48\n116\nM\n0\n5\nM\n\n\nW70\nW70\nF\n49\n3\nF\n0\n152\nF\n5\n0\nF\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nIMPORTANT We created this function with the explicit intent that a human checks the evidence for the agreed sex that do NOT agree for all types of sex-linked loci (denoted as ‘*M’ or ‘*F’). This human can then use their criterion to validate these assignments.\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nCan you find individuals for which the agreed sex is uncertain (i.e., has an asterisk “*”)?"
  },
  {
    "objectID": "session10.html#dataset-2---xxxy---the-leadbeaters-possum",
    "href": "session10.html#dataset-2---xxxy---the-leadbeaters-possum",
    "title": "10  Sex Linked Markers",
    "section": "Dataset 2 - XX/XY - The Leadbeater’s possum",
    "text": "Dataset 2 - XX/XY - The Leadbeater’s possum\n\n\n\nThe Leadbeater’s possum\n\n\n\nLoad data\n\ndata(\"LBP\")\nLBP  # Explore the dataset\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1,000 SNPs , size: 5.2 Mb\n\n    missing data: 20670 (=5.5 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1000 locus labels\n   @loc.all:  1000 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nLBP@n.loc  # Number of SNPs\n\n[1] 1000\n\nlength(LBP@ind.names)  # Number of individuals\n\n[1] 376\n\n\n\n\nRun filter.sex.linked\nThis function identifies sex-linked and autosomal loci present in a SNP dataset (genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\nThe genlight object must contain in gl@other$ind.metrics a column named “id”, and a column named “sex” in which individuals with known-sex are assigned ‘M’ for male, or ‘F’ for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\n\nXX/XY sex chromosomes\n\n\n\nknitr::kable(head(LBP@other$ind.metrics))  # Check that ind.metrics has the necessary columns\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nsex\npop\nYear.collected\nservice\nplate_location\n\n\n\n\nY2\nY2\nF\nYellingbo\n1997\nDLpos17-2786\n1-A1\n\n\nY16\nY16\nM\nYellingbo\n2001\nDLpos17-2786\n1-A10\n\n\nY17\nY17\nF\nYellingbo\n1997\nDLpos17-2786\n1-A11\n\n\nY18\nY18\nF\nYellingbo\n1999\nDLpos17-2786\n1-A12\n\n\nY3\nY3\nF\nYellingbo\n1997\nDLpos17-2786\n1-A2\n\n\nY4\nY4\nM\nYellingbo\n1997\nDLpos17-2786\n1-A3\n\n\n\n\nres &lt;- dartR.sexlinked::filter.sex.linked(gl = LBP, system = \"xy\")\n\nDetected 162 females and 211 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\n\n\n\nDone. Starting phase 2.\n\n\nBuilding heterozygosity plots.\n\n\n\n\n\n\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nFound 77 sex-linked loci:\n   1 Y-linked loci\n   9 sex-biased loci\n   66 X-linked loci\n   1 XY gametologs.\nAnd 923 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\nExercise\n\n\n\n\nHow many males and females does the dataset contain?\nHow many sex-linked loci were found?\n\n\nNow check the output:\n\nres$y.linked  # Notice that it says 'y-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1 SNPs , size: 4.7 Mb\n\n    missing data: 164 (=43.62 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1 locus labels\n   @loc.all:  1 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$x.linked  # Notice that it says 'x-linked'\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  66 SNPs , size: 4.7 Mb\n\n    missing data: 827 (=3.33 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  66 locus labels\n   @loc.all:  66 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$gametolog\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  1 SNPs , size: 4.7 Mb\n\n    missing data: 0 (=0 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  1 locus labels\n   @loc.all:  1 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$sex.biased\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  9 SNPs , size: 4.7 Mb\n\n    missing data: 853 (=25.21 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  9 locus labels\n   @loc.all:  9 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nres$autosomal\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 376 genotypes,  923 SNPs , size: 5.2 Mb\n\n    missing data: 18826 (=5.42 %) scored as NA\n\n ** Genetic data\n   @gen: list of 376 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  376 individual labels\n   @loc.names:  923 locus labels\n   @loc.all:  923 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 95-281)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, sex, pop, Year.collected, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Possum_v2, ChromPos_Possum_v2, AlnCnt_Possum_v2, AlnEvalue_Possum_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC \n   @other$latlon[g]: no coordinates attached\n\nknitr::kable(head(res$results.table))  # The output table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nindex\ncount.F.miss\ncount.M.miss\ncount.F.scored\ncount.M.scored\nratio\np.value\np.adjusted\nscoringRate.F\nscoringRate.M\ny.linked\nsex.biased\ncount.F.het\ncount.M.het\ncount.F.hom\ncount.M.hom\nstat\nstat.p.value\nstat.p.adjusted\nheterozygosity.F\nheterozygosity.M\nx.linked\nxy.gametolog\n\n\n\n\n28681424-34-G/T\n1\n0\n1\n162\n210\n1.2953770\n1.0000000\n1\n1.0000000\n0.9952607\nFALSE\nFALSE\n1\n0\n161\n210\n1.303397\n1.0000000\n1.0000000\n0.0061728\n0.0000000\nFALSE\nFALSE\n\n\n28678947-56-C/T\n2\n12\n8\n150\n203\n2.0261283\n0.1638428\n1\n0.9259259\n0.9620853\nFALSE\nFALSE\n9\n7\n141\n196\n1.784196\n0.3044519\n0.9598961\n0.0600000\n0.0344828\nFALSE\nFALSE\n\n\n28680567-32-T/G\n3\n12\n12\n150\n199\n1.3256351\n0.5289429\n1\n0.9259259\n0.9431280\nFALSE\nFALSE\n9\n11\n141\n188\n1.090635\n1.0000000\n1.0000000\n0.0600000\n0.0552764\nFALSE\nFALSE\n\n\n28688313-7-C/G\n4\n0\n0\n162\n211\n1.3015303\n1.0000000\n1\n1.0000000\n1.0000000\nFALSE\nFALSE\n6\n0\n156\n211\n8.076192\n0.0459068\n0.3917911\n0.0370370\n0.0000000\nFALSE\nFALSE\n\n\n28681679-51-C/T\n5\n22\n30\n140\n181\n0.9482168\n0.8814171\n1\n0.8641975\n0.8578199\nFALSE\nFALSE\n1\n1\n139\n180\n1.293900\n1.0000000\n1.0000000\n0.0071429\n0.0055249\nFALSE\nFALSE\n\n\n28681994-14-G/A\n6\n0\n1\n162\n210\n1.2953770\n1.0000000\n1\n1.0000000\n0.9952607\nFALSE\nFALSE\n18\n19\n144\n191\n1.255791\n0.6007790\n1.0000000\n0.1111111\n0.0904762\nFALSE\nFALSE\n\n\n\n\n\nThe output consists of a genlight object for each type of loci, plus a results table.\n\n\nRun infer.sex\nThis function uses the output of function filter.sex.linked (list of 6 objects) to infer the sex of all individuals in the dataset. It uses 3 types of sex-linked loci (W-/Y-linked, Z-/X-linked, and gametologs), assigns a preliminary genetic sex for each type of sex-linked loci available, and outputs an agreed sex.\n\nsexID &lt;- dartR.sexlinked::infer.sex(gl_sex_filtered = res, system = \"xy\",\n    seed = 124)\n\nNot enough gametologs (need at least 5). Assigning NA...\n\n\n***FINISHED***\n\nknitr::kable(head(sexID))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\ny.linked.sex\n#called\n#missing\nx.linked.sex\n#Het.x\n#Hom.x\ngametolog.sex\n#Het.g\n#Hom.g\nagreed.sex\n\n\n\n\nY2\nY2\nF\n0\n1\nF\n19\n47\nNA\nNA\nNA\nF\n\n\nY16\nY16\nM\n1\n0\nM\n2\n56\nNA\nNA\nNA\nM\n\n\nY17\nY17\nF\n0\n1\nF\n27\n37\nNA\nNA\nNA\nF\n\n\nY18\nY18\nF\n0\n1\nM\n4\n62\nNA\nNA\nNA\n*F\n\n\nY3\nY3\nM\n1\n0\nM\n3\n63\nNA\nNA\nNA\nM\n\n\nY4\nY4\nM\n1\n0\nM\n1\n63\nNA\nNA\nNA\nM\n\n\n\n\n\nWhat did the function mention about gametologs? How did that impact the results table? How many types of sex-linked loci were used to infer an agreed sex?\n\n\n\n\n\n\nExercise\n\n\n\n\nCan you find individuals for which the agreed sex is uncertain (i.e., has an asterisk “*”)?"
  },
  {
    "objectID": "session10.html#exercise-4",
    "href": "session10.html#exercise-4",
    "title": "10  Sex Linked Markers",
    "section": "EXERCISE",
    "text": "EXERCISE\n\n\n\n\n\n\nExercise\n\n\n\n\nImagine you are analyzing the genetic data of a population and you want to look at its genetic structure and genetic diversity. You get to work by filtering your beautiful set of SNPs. Because you are a rigorous, you want to test whether using function filter.sex.linked to properly filter out sex-linked loci changes the results of the populations analyses. So you: (1) process your SNP dataset by applying standard filters and run analyses, and (2) process the dataset by filtering out sex-linked loci first, applying standard filters second, and then run analyses.\nChoose one of the following datasets (or your own data) and report:\n\nHow many sex-linked markers are present?\nHow many individuals had a wrong sexID?\nDo you see any changes in your PCA/structure analyses when you filtered out sex-linked markers versus when you did not?\nDo you see any differences in genetic diversity and fixation indices when you filtered out sex-linked markers versus when you did not?"
  },
  {
    "objectID": "session10.html#exercises",
    "href": "session10.html#exercises",
    "title": "10  Sex Linked Markers",
    "section": "EXERCISES",
    "text": "EXERCISES\n\n\n\n\n\n\nExercise\n\n\n\n\nImagine you are analyzing the genetic data of a population and you want to look at its genetic structure and genetic diversity. You get to work by filtering your beautiful set of SNPs. Because you are a rigorous, you want to test whether using function filter.sex.linked to properly filter out sex-linked loci changes the results of the populations analyses. So you: (1) process your SNP dataset by applying standard filters and run analyses, and (2) process the dataset by filtering out sex-linked loci first, applying standard filters second, and then run analyses.\nChoose one of the following datasets (or your own data) and report:\n\nHow many sex-linked markers are present?\nHow many individuals had a wrong sexID?\nDo you see any changes in your PCA/structure analyses when you filtered out sex-linked markers versus when you did not?\nDo you see any differences in genetic diversity and fixation indices when you filtered out sex-linked markers versus when you did not?"
  },
  {
    "objectID": "session01.html#diversity-arrays-technology-dart",
    "href": "session01.html#diversity-arrays-technology-dart",
    "title": "1  Intro to dartR",
    "section": "Diversity Arrays Technology (DArT)",
    "text": "Diversity Arrays Technology (DArT)\n\nDiversity Arrays Technology Pty Ltd (DArT) is a private company that specializes in genotyping by sequencing. Their approach is one of genome complexity reduction. Basically, DArTSeq is a method that extracts reproducible genomic variation across the genomes of many individuals at an affordable cost. The data are representational in the sense that they are generated for a random but reproducible selection of small fragments of sequence only, fragments that exhibit variation at the level of single base pairs (SNPs).\nFor more details check out the DArT website: https://www.diversityarrays.com/\nYou can also learn more about the methods by checking out the tutorial on Data Structure and Input found in the dartR Tutorials section.\n\nTheir mission"
  },
  {
    "objectID": "session01.html#diversity-arrays-technology-pty-ltd-dart",
    "href": "session01.html#diversity-arrays-technology-pty-ltd-dart",
    "title": "1  Intro to dartR",
    "section": "Diversity Arrays Technology Pty Ltd (DArT)",
    "text": "Diversity Arrays Technology Pty Ltd (DArT)\n\nDiversity Arrays Technology Pty Ltd (DArT) is a private company that specializes in genotyping by sequencing. Their approach is one of genome complexity reduction. Basically, DArTSeq is a method that extracts reproducible genomic variation across the genomes of many individuals at an affordable cost. The data are representational in the sense that they are generated for a random but reproducible selection of small fragments of sequence only, fragments that exhibit variation at the level of single base pairs (SNPs).\nFor more details check out the DArT website: https://www.diversityarrays.com/\nYou can also learn more about the methods by checking out the tutorial on Data Structure and Input found in the dartR Tutorials section.\n\nTheir mission:"
  },
  {
    "objectID": "session01.html#filtering-strategies",
    "href": "session01.html#filtering-strategies",
    "title": "1  Intro to dartR",
    "section": "Filtering strategies",
    "text": "Filtering strategies\nThere is no right filtering order. Your data set will need its own interrogation, so be iterative - test different options. In some cases you may even need to reuse a filter that you used earlier on in the filtering process.\nInstead of providing a recipe to follow, I recommend strategies to filtering.\nFirst, lets have a closer look at what some of these filters do (click across the tabs for more insight into each filter):\n\nFilterscallrate: loccallrate: indreproducibilityrdepthmafsecondaries\n\n\n\ngl.filter.callrate(method = loc) # Call rate by loci (SNPs)\ngl.filter.callrate(method = ind) # Call rate by individuals\ngl.filter.reproducibility()      # reproducibility \ngl.filter.rdepth()               # read depth \ngl.filter.maf()                  # minor allele frequency \ngl.filter.secondaries()          # secondaries \n\n\n\ngl.filter.callrate(gl, method = \"loc\", threshold = 0.95)\nWhat is it? Removes SNPs with too much missing data based on a specified threshold.\nWhy is it important? Missing loci can add “noise” and computation time to an analysis\nKey Considerations:\n\nTrade-off between strength of filter and number of loci\nCall rate filters matter for different metrics\n\n\n\n\ngl.filter.callrate(gl, method = \"ind\", threshold = 0.95)\nWhat is it? Removes individuals with too much missing data based on a specified threshold.\nWhy is it important? Deletes the key thing you need to do a study, and removes individuals that may be misleading as they are sequencing outliers\nKey Considerations:\n\nThe filtering step that costs you the very most amount of money\nGenerally not a first step – recommend filtering lightly here in the first go and seeing if other filters improve the individuals completeness\n\n\n\n\ngl.filter.reproducibility()\nWhat is it? Diversity Arrays duplicates individuals during library prep, to assess whether the same answer is found for every locus ~ a control.\nWhy is it important? Provides confidence in your base calls which is pretty fundamental\nKey Considerations:\n\nIf reproducibility is low, you need your SNPs re-assessed\nIf doing sequencing through AGRF or other facilities, make sure to include duplicated individuals (this is an additional cost but do it anyway)\n\n\n\ngl.filter.rdepth()\nWhat is it? The mean number of sequencing reads for a particular locus, across all individuals.\nWhy is it important? The number of reads in a stack tells you how confident you can be in your base calls and a low read depth means that your heterozygous sites have pretty low coverage.\nKey Considerations:\n\nIf your read depth is not high enough, there are questions you can’t confidently answer (e.g., heterozygosity)\nVery high read depth suggests paralogs (genes with multiple copies) being assembled in to one fragment\n\n\n\n\ngl.filter.maf()\nWhat is it? Minor allele frequency (maf) is the frequency of the second most common allele in a given population, so this filter removes SNPs based on their relative proportion.\nImportantly, in the literature, it is often set to 0.05 BUT…\nKey Considerations:\n\n0.05 can be high if you have lot of individuals\n\nIf you have 300 diploid individuals, then you delete SNPs with less than 30 copies of the minor allele\n\nOr singleton if you have a small number of individuals\nShould depend on your question\n\nRare alleles can be very important to certain questions\nMost SNPs are rare alleles, as are most heterozygous sites\nRare alleles are important in expansion processes\nNOT important in structure or phylogenetic analyses\n\n\n\n\n\ngl.filter.secondaries()\nWhat is it? When there are two SNPs on a single fragment, choosing to keep only one.\nWhy is it important? Loci that are very close together in the genome are not independently inherited as they are too close together for recombination to split, so they tend to be inherited together.\nKey Considerations:\n\nCan mislead structure and phylogenetic analyses\nCan improve representations of heterozygosity\n\n\n\n\n\n\nStrategies\nNow for some strategies,\nas a starting point I would get rid of loci I don’t believe in and then individuals that didn’t work properly at all:\n\ngl &lt;- platypus.gl # example data from dartR.data\n\ngl &lt;- gl.filter.callrate(gl, method = \"loc\", threshold = 0.7)\n# Get rid of really poorly sequenced loci, but don’t cut hard\n\ngl &lt;- gl.filter.callrate(gl, method = \"ind\", threshold = 0.25)\n# Very low filter – this is only to get rid of your really bad \n# individuals\n\ngl &lt;- gl.filter.monomorphs(gl)\n# Always run this after removing individuals – removes loci that are no\n# longer variable\n\ngl &lt;- gl.filter.reproducibility(gl)\n# Get rid of unreliable loci\n\ngl &lt;- gl.filter.rdepth(gl, lower = 5, upper = 500)\n# Get rid of low and super high read depth loci\n\nThen I would filter more strongly as appropriate for my question. For a population structure analysis I would,\n\ngl &lt;- gl.filter.callrate(gl, method = \"loc\", threshold = 0.95)\n# Structure dislikes missing data\n\ngl &lt;- gl.filter.maf(gl,  threshold = 1/(2*nInd(gl)))\n# I usually set up the threshold so it is just removing singletons to\n# improve computation time\n\ngl &lt;- gl.filter.secondaries(gl)\n# Always do this as the last loci filter so that you’ve cut for quality\n# before you cut because there are two SNPs\n\ngl &lt;- gl.filter.callrate(gl, method = \"ind\", threshold = .9)\n# Filter on individuals. You can usually be a bit flexible at this \n# point.\n\ngl &lt;- gl.filter.monomorphs(gl)\n# Always run this after removing individuals\n\n\n\n\n\n\n\nMore tips\n\n\n\nKeep these tips in mind when you go to filter your own data:\n\nBe flexible\nKnow what each filter is doing to your data\nThink carefully about whether the filter is appropriate to the test you want to run\nAnalyse your data many different ways\nDon’t over-interpret your PCoA"
  },
  {
    "objectID": "session01.html#filtering-strategies-or-the-art-of-filtering",
    "href": "session01.html#filtering-strategies-or-the-art-of-filtering",
    "title": "1  Intro to dartR",
    "section": "Filtering strategies (or the Art of Filtering)",
    "text": "Filtering strategies (or the Art of Filtering)"
  },
  {
    "objectID": "session01.html#filtering-strategies-art-of-filtering",
    "href": "session01.html#filtering-strategies-art-of-filtering",
    "title": "1  Intro to dartR",
    "section": "Filtering strategies (Art of Filtering)",
    "text": "Filtering strategies (Art of Filtering)"
  },
  {
    "objectID": "session01.html#filtering-strategies-the-art-of-filtering",
    "href": "session01.html#filtering-strategies-the-art-of-filtering",
    "title": "1  Intro to dartR",
    "section": "Filtering strategies (the Art of Filtering)",
    "text": "Filtering strategies (the Art of Filtering)"
  },
  {
    "objectID": "session01.html#dartrs-reach",
    "href": "session01.html#dartrs-reach",
    "title": "1  Intro to dartR",
    "section": "dartR’s Reach",
    "text": "dartR’s Reach"
  },
  {
    "objectID": "session01.html#exploring-functions",
    "href": "session01.html#exploring-functions",
    "title": "1  Intro to dartR",
    "section": "Exploring functions",
    "text": "Exploring functions\n\n\n\n\n\n\nExercise\n\n\n\n Try some of these report, subset, and filtering functions on your own.\n\nReporting\n\ngl.report.callrate()\ngl.report.reproducibility()\ngl.report.secondaries()\ngl.report.rdepth()\ngl.report.monomorphs()\ngl.report.overhang()\ngl.report.hamming()\ngl.report.overshoot()\n\n\n\nSubsetting\n\ngl.keep.ind()\ngl.drop.ind()\ngl.keep.loc()\ngl.drop.loc()\ngl.keep.pop()\ngl.drop.pop()\ngl.merge.pop()\ngl.subsample.ind()\ngl.subsample.loc()\n\n\n\nfiltering\n\ngl.filter.callrate()\ngl.filter.reproducibility()\ngl.filter.secondaries()\ngl.filter.rdepth()\ngl.filter.monomorphs()\ngl.filter.overhang()\ngl.filter.hamming()\ngl.filter.overshoot()"
  }
]